# IT拨测系统后端代码文件用途说明

## 项目概述
IT拨测系统后端是一个基于Flask框架开发的RESTful API服务，提供用户管理、节点管理、任务调度、拨测执行和结果查询等核心功能。系统采用SQLite数据库存储数据，使用JWT进行身份认证，并通过APScheduler实现定时任务调度。系统支持多租户架构，具备完善的告警和报表功能。

## 项目结构总览
## 项目结构总览
backend/ ├── app/ # 核心应用目录 │ ├── init.py # Flask应用工厂函数 │ ├── config.py # 应用配置类 │ ├── requirements.txt # Python依赖列表 │ ├── api/ # API路由 │ │ ├── v1/ # API路由版本1 │ │ │ ├── init.py # 路由初始化 │ │ │ ├── auth.py # 认证相关接口 │ │ │ ├── users.py # 用户管理接口 │ │ │ ├── nodes.py # 节点管理接口 │ │ │ ├── tasks.py # 任务管理接口 │ │ │ ├── results.py # 结果查询接口 │ │ │ ├── system_variables.py # 系统变量管理接口 │ │ │ └── alerts.py # 告警接口 │ │ ├── v2/ # API路由版本2 │ │ ├── reports.py # 报表相关接口 │ │ └── subscriptions.py # 报表订阅相关接口 │ ├── models/ # 数据模型 │ │ ├── init.py # 模型导出 │ │ ├── user.py # 用户数据模型 │ │ ├── task.py # 任务数据模型 │ │ ├── result.py # 结果数据模型 │ │ ├── node.py # 节点数据模型 │ │ ├── system_variable.py # 系统变量数据模型 │ │ ├── alert.py # 告警数据模型 │ │ ├── alarm.py # 告警历史数据模型 │ │ ├── report.py # 报表数据模型 │ │ └── tenant.py # 租户数据模型 │ ├── scheduler.py # 定时任务调度器 │ ├── services/ # 业务服务层 │ │ ├── init.py # 服务导出 │ │ ├── alert_matcher.py # 告警匹配服务 │ │ └── alert_state_manager.py # 告警状态管理服务 │ ├── tasks/ # 定时任务实现 │ │ └── report_scheduler.py # 报表定时推送任务 │ └── utils/ # 工具类 │ ├── agent_auth.py # Agent认证工具 │ ├── auth_decorators.py # 认证装饰器 │ ├── email_service.py # 邮件服务工具 │ ├── export_utils.py # 导出工具 │ ├── quota_checker.py # 配额检查工具 │ └── tenant_context.py # 租户上下文工具 ├── alembic/ # 数据库迁移工具 │ ├── versions/ # 数据库迁移脚本 │ └── env.py # Alembic环境配置 ├── scripts/ # 脚本目录 │ └── migrate_to_multi_tenant.py # 多租户迁移脚本 ├── run.py # 应用启动入口 ├── init_db.py # 数据库初始化脚本 ├── init_system_variables.py # 系统变量表初始化脚本 ├── init_default_reports.py # 默认报表初始化脚本 ├── create_superadmin.py # 超级管理员创建脚本 ├── update_foreign_key.py # 外键更新脚本 ├── remove_node_tenant_binding.py # 移除节点租户绑定脚本 ├── load_env.py # 环境变量加载脚本 ├── logging.conf # 日志配置文件 ├── logging_config.py # 日志配置类 ├── Dockerfile # 后端Docker配置 └── alembic.ini # 数据库迁移配置

## 核心文件详细说明

### 1. 配置文件

#### **run.py** - 应用启动入口
- 功能：创建Flask应用实例并启动服务
- 配置：在0.0.0.0:5001端口运行，debug模式
- 作用：作为应用的主入口点，负责启动整个后端服务

#### **init_db.py** - 数据库初始化脚本
- 功能：创建数据库表结构
- 实现：调用SQLAlchemy的create_all()方法创建所有数据表
- 使用：首次部署时执行，初始化数据库结构

#### **init_system_variables.py** - 系统变量表初始化脚本
- 功能：专门用于初始化系统变量表
- 实现：检查system_variables表是否存在，如果不存在则创建
- 使用：在系统部署时确保系统变量表存在

#### **init_default_reports.py** - 默认报表初始化脚本
- 功能：初始化默认报表配置
- 实现：创建默认的报表模板和订阅配置
- 使用：在系统部署时初始化报表功能

#### **create_superadmin.py** - 超级管理员创建脚本
- 功能：创建系统超级管理员账户
- 实现：创建具有超级管理员权限的默认用户
- 使用：系统初始化时创建管理员账户

#### **app/config.py** - 应用配置类
- **Config类**：集中管理所有配置参数
  - **安全配置**：SECRET_KEY（会话密钥）、JWT_SECRET_KEY（JWT签名密钥）、JWT_ACCESS_TOKEN_EXPIRES（30分钟过期）
  - **环境配置**：ENV（默认development）
  - **数据库配置**：SQLALCHEMY_DATABASE_URI（SQLite路径）、SQLALCHEMY_TRACK_MODIFICATIONS（禁用修改跟踪）
  - **调度器配置**：SCHEDULER_API_ENABLED（启用API）
  - **CORS配置**：ALLOWED_ORIGINS（允许跨域来源列表，包含开发环境常用端口）
  - **邮件配置**：SMTP服务器、端口、用户名、密码等配置

#### **app/requirements.txt** - Python依赖列表
- **核心框架**：Flask 2.3.3（Web框架）、Flask-SQLAlchemy 3.0.5（ORM）
- **认证安全**：PyJWT 2.8.0（JWT令牌）、bcrypt 4.0.1（密码加密）、Werkzeug 2.3.7（WSGI工具）
- **API文档**：flask-restx 1.1.0（Swagger文档）、flask-cors 4.0.0（跨域支持）
- **任务调度**：APScheduler 3.10.1（定时任务）
- **数据库**：alembic 1.12.0（数据库迁移）
- **测试工具**：pytest 7.4.2（测试框架）、factory-boy 3.3.0（测试数据工厂）
- **HTTP客户端**：requests 2.31.0（HTTP请求）
- **环境管理**：python-dotenv 1.0.0（环境变量）
- **邮件服务**：smtplib（标准库邮件发送）

### 2. 数据模型（models/）

#### **app/models/user.py** - 用户数据模型
- **User类**：定义用户表结构
  - **字段**：id（主键）、username（用户名）、email（邮箱）、password_hash（加密密码）、role（角色）、status（状态）、created_at（创建时间）、updated_at（更新时间）
  - **方法**：set_password（密码加密存储）、check_password（密码验证）、to_dict（序列化为字典）
  - **角色**：支持admin（管理员）、operator（操作员）、viewer（查看者）
  - **状态**：支持激活/禁用用户

#### **app/models/task.py** - 任务数据模型
- **Task类**：定义拨测任务表结构
  - **字段**：id（主键）、name（任务名称）、type（任务类型：ping/tcp/http/api等）、target（目标地址）、interval（执行间隔秒）、enabled（启用状态）、config（JSON配置）、agent_ids（执行节点ID数组JSON）、创建和更新时间
  - **方法**：to_dict（序列化，自动解析agent_ids JSON数组）
  - **任务类型**：支持ping（ICMP探测）、tcp（TCP端口探测）、http（HTTP探测）、api（API接口测试）
  - **关系**：与Result模型建立一对多关系

#### **app/models/result.py** - 结果数据模型
- **Result类**：定义拨测结果表结构
  - **字段**：id（主键）、task_id（外键关联任务）、status（执行状态）、response_time（响应时间ms）、message（结果消息）、details（详细结果JSON）、agent_id（执行节点ID）、agent_area（执行节点区域）、created_at（执行时间）
  - **关系**：与Task模型建立一对多关系（一个任务多个结果）
  - **方法**：to_dict（序列化，自动解析details JSON数据）
  - **外键约束**：配置了级联删除（CASCADE）

#### **app/models/node.py** - 节点数据模型
- **Node类**：定义拨测节点表结构
  - **字段**：id（主键）、agent_id（节点唯一标识）、agent_area（节点区域）、ip_address（IP地址）、hostname（主机名）、status（在线状态）、last_heartbeat（最后心跳时间）、created_at（创建时间）、updated_at（更新时间）
  - **状态值**：online（在线）、offline（离线）、timeout（超时）
  - **方法**：to_dict（序列化为字典）

#### **app/models/system_variable.py** - 系统变量数据模型
- **SystemVariable类**：定义系统变量表结构
  - **字段**：id（主键）、name（变量名，格式为$public_xxx）、value（变量值）、description（变量描述）、is_secret（是否为密钥变量）、created_at（创建时间）、updated_at（更新时间）
  - **方法**：validate_name（验证变量名格式）、to_dict（序列化为字典）

#### **app/models/alert.py** - 告警数据模型
- **Alert类**：定义告警记录表结构
  - **字段**：id（主键）、task_id（外键关联任务）、step_id（API任务步骤ID）、alert_type（告警类型）、alert_level（告警级别）、status（状态）、title（标题）、content（内容）、trigger_value（触发值）、threshold_value（阈值）、agent_id（触发节点ID）、agent_area（触发节点区域）、snapshot_data（快照数据JSON）、assigned_to（分配用户）、resolved_by（处理人）、resolved_at（处理时间）、created_at（创建时间）、updated_at（更新时间）
  - **方法**：to_dict（序列化，自动解析快照数据JSON）、set_snapshot_data（设置快照数据）、get_snapshot_data（获取快照数据）
  - **告警类型**：status_code（状态码）、response_time（响应时间）、task_status（任务状态）、task_timeout（任务超时）、assertion_failed（断言失败）
  - **告警级别**：critical（严重）、warning（警告）、info（信息）
  - **状态**：pending（待处理）、resolved（已解决）、ignored（已忽略）

- **AlertConfig类**：定义告警配置表结构
  - **字段**：id（主键）、task_id（外键关联任务）、step_id（API任务步骤ID）、alert_type（告警类型）、enabled（启用状态）、config（JSON配置）、min_points（监测点数量阈值）、min_occurrences（连续次数阈值）、trigger_mode（逻辑模式）、created_at（创建时间）、updated_at（更新时间）
  - **方法**：to_dict（序列化，自动解析配置JSON）、set_config（设置配置数据）、get_config（获取配置数据）

#### **app/models/alarm.py** - 告警历史数据模型
- **Alarm类**：定义告警历史表结构
  - **字段**：id（主键）、task_id（外键关联任务）、task_name（冗余存储任务名称）、alarm_type（告警类型）、level（告警级别）、status（状态）、message（告警消息）、trigger_value（触发值）、threshold_value（阈值）、created_at（创建时间）、resolved_at（解决时间）
  - **方法**：to_dict（序列化为字典）、resolve（标记告警为已解决）

#### **app/models/report.py** - 报表数据模型
- **Report类**：定义报表表结构
  - **字段**：id（主键）、type（报表类型：tcp/ping/http/api）、task_ids（任务ID数组JSON）、time_range（时间范围配置JSON）、metrics（指标集合JSON）、generate_time（生成时间）、file_path（文件路径）、created_at（创建时间）、updated_at（更新时间）
  - **方法**：get_task_ids（获取任务ID列表）、set_task_ids（设置任务ID列表）、get_time_range（获取时间范围配置）、set_time_range（设置时间范围配置）、get_metrics（获取指标集合）、set_metrics（设置指标集合）、to_dict（序列化为字典）

- **ReportSubscription类**：定义报表订阅表结构
  - **字段**：id（主键）、type（报表类型：tcp/ping/http/api）、task_ids（任务ID数组JSON）、period（周期：daily/weekly/monthly）、target（推送目标配置JSON）、enabled（启用状态）、last_sent（上次发送时间）、create_time（创建时间）、created_at（创建时间）、updated_at（更新时间）
  - **方法**：get_task_ids（获取任务ID列表）、set_task_ids（设置任务ID列表）、get_target（获取推送目标配置）、set_target（设置推送目标配置）、to_dict（序列化为字典）

#### **app/models/tenant.py** - 租户数据模型
- **Tenant类**：定义租户表结构（支持多租户架构）
  - **字段**：id（主键，UUID）、name（租户名称）、description（租户描述）、subscription_level（订阅级别：free/pro/enterprise）、max_tasks（任务数量上限）、max_nodes（节点数量上限）、max_variables（变量数量上限）、max_alerts（告警规则上限）、status（租户状态：active/inactive/suspended）、created_at（创建时间）、updated_at（更新时间）、meta_data（扩展字段JSON）
  - **方法**：get_default_limits（根据订阅级别获取默认限额）、get_usage_stats（获取租户资源使用统计）、check_resource_limit（检查资源是否超限）、to_dict（序列化为字典）

- **UserTenant类**：定义用户-租户关联表结构
  - **字段**：user_id（用户ID，联合主键）、tenant_id（租户ID，联合主键）、role（用户在租户中的角色：user/tenant_admin/super_admin）、created_at（创建时间）
  - **方法**：get_user_tenants（获取用户关联的所有租户）、get_tenant_users（获取租户下的所有用户）、has_permission（检查用户在租户中是否有指定权限）、is_super_admin（检查用户是否为超级管理员）、to_dict（序列化为字典）

### 3. API路由（api/）

#### **app/api/v1/__init__.py** - 路由初始化
- **Blueprint**：创建api_v1蓝图，统一路由前缀
- **健康检查**：/api/v1/health端点，用于服务状态监控
- **模块导入**：自动导入所有路由模块（auth、users、nodes、tasks、results、alerts、system_variables）

#### **app/api/v1/auth.py** - 认证相关接口
- **POST /api/v1/auth/login**：用户登录
  - 验证用户名密码
  - 生成JWT访问令牌和刷新令牌
  - 设置HTTP-only刷新令牌cookie
  - 返回用户信息和新令牌
- **POST /api/v1/auth/refresh**：令牌刷新
  - 使用刷新令牌获取新的访问令牌
  - 处理令牌过期和无效情况

#### **app/api/v1/users.py** - 用户管理接口
- **GET /api/v1/users**：获取用户列表
  - 支持分页查询（page、size参数）
  - 支持角色筛选（role参数）
  - 支持关键词搜索（keyword参数，搜索用户名和邮箱）
- **POST /api/v1/users**：创建用户
  - 验证用户名唯一性
  - 密码加密存储
  - 支持设置角色和状态
- **PATCH /api/v1/users/<id>**：更新用户信息
  - 支持修改用户名、邮箱、角色、状态
- **PATCH /api/v1/users/<id>/password**：重置用户密码
- **DELETE /api/v1/users/<id>**：删除用户
  - 防止删除默认的test用户

#### **app/api/v1/tasks.py** - 任务管理接口
- **GET /api/v1/tasks**：获取任务列表
  - 支持分页、类型筛选、状态筛选、关键词搜索
- **GET /api/v1/tasks/<id>**：获取任务详情
- **POST /api/v1/tasks**：创建任务
  - 支持多种任务类型（ping、tcp、http、api等）
  - API任务支持多步骤配置
  - 支持系统变量引用
  - 验证Agent节点存在性
- **PUT /api/v1/tasks/<id>**：更新任务
  - 支持启用/禁用任务
  - 支持修改执行间隔和配置
- **DELETE /api/v1/tasks/<id>**：删除任务
  - 级联删除相关执行结果

#### **app/api/v1/results.py** - 结果查询接口
- **GET /api/v1/results**：获取结果列表
  - 支持按任务ID筛选
  - 支持时间范围查询
  - 支持分页和排序
- **GET /api/v1/results/<int:result_id>**：获取单个结果详情
- **POST /api/v1/results**：创建结果
  - 支持指定agent_id和agent_area
  - 支持自定义创建时间

#### **app/api/v1/nodes.py** - 节点管理接口
- **GET /api/v1/nodes**：获取节点列表
  - 支持状态筛选
  - 支持关键词搜索
  - 显示节点在线状态和最后心跳
- **POST /api/v1/nodes/register**：注册节点
- **POST /api/v1/nodes/heartbeat**：更新节点心跳
- **PUT /api/v1/nodes/<id>**：更新节点信息
- **DELETE /api/v1/nodes/<id>**：删除节点
- **POST /api/v1/nodes/timeout-check**：检查超时节点

#### **app/api/v1/system_variables.py** - 系统变量管理接口
- **GET /api/v1/system-variables**：获取系统变量列表
  - 支持分页查询
  - 支持关键词搜索
- **POST /api/v1/system-variables**：创建系统变量
  - 变量名必须以$开头，后跟字母、数字或下划线
  - 支持变量描述和密钥标记
- **GET /api/v1/system-variables/<id>**：获取系统变量详情
- **PUT /api/v1/system-variables/<id>**：更新系统变量
- **DELETE /api/v1/system-variables/<id>**：删除系统变量

#### **app/api/v1/alerts.py** - 告警接口
- **GET /api/v1/alerts**：获取告警列表
  - 支持分页查询
  - 支持按状态、级别、任务ID筛选
- **GET /api/v1/alerts/stats**：获取告警统计信息
- **PUT /api/v1/alerts/<id>**：更新告警状态
- **DELETE /api/v1/alerts/<id>**：删除告警

#### **app/api/reports.py** - 报表接口
- **GET /api/reports/templates**：获取报表模板列表
- **POST /api/reports/generate**：生成报表
- **GET /api/reports/history**：获取报表历史记录
- **GET /api/reports/<id>/download**：下载报表文件

#### **app/api/subscriptions.py** - 报表订阅接口
- **GET /api/subscriptions**：获取报表订阅列表
- **POST /api/subscriptions**：创建报表订阅
- **PUT /api/subscriptions/<id>**：更新报表订阅
- **DELETE /api/subscriptions/<id>**：删除报表订阅
- **POST /api/subscriptions/<id>/test**：测试报表订阅

### 4. 业务服务层（services/）

#### **app/services/alert_matcher.py** - 告警匹配服务
- **AlertMatcher类**：负责根据agent上报的API步骤数据进行告警规则匹配
  - **process_result方法**：处理agent上报的结果数据，检查是否触发告警
  - **match_alert_configs方法**：匹配告警配置规则
  - **create_alert方法**：创建告警记录
  - **should_trigger_alert方法**：判断是否应该触发告警（基于监测点数量和连续次数阈值）

#### **app/services/alert_state_manager.py** - 告警状态管理服务
- **AlertStateManager类**：负责管理告警状态，避免重复告警
  - **should_create_alert方法**：判断是否应该创建新的告警记录
  - **update_alert_state方法**：更新告警状态
  - **clear_alert_state方法**：清除告警状态

### 5. 定时任务（tasks/）

#### **app/tasks/report_scheduler.py** - 报表定时推送任务
- **ReportScheduler类**：处理报表订阅的定时推送功能
  - **send_daily_reports方法**：发送每日报表
  - **send_weekly_reports方法**：发送每周报表
  - **send_monthly_reports方法**：发送每月报表
  - **_send_reports_by_frequency方法**：根据频率发送报表
  - **_generate_and_send_report方法**：生成并发送报表

### 6. 工具类（utils/）

#### **app/utils/email_service.py** - 邮件服务工具
- **EmailService类**：提供邮件发送功能，支持报表推送
  - **send_email方法**：发送邮件
  - **send_report_email方法**：发送报表邮件

#### **app/utils/export_utils.py** - 导出工具
- **ExportUtils类**：提供数据导出功能
  - **export_to_excel方法**：导出数据到Excel
  - **export_to_csv方法**：导出数据到CSV
  - **export_to_pdf方法**：导出数据到PDF

#### **app/utils/auth_decorators.py** - 认证装饰器
- **tenant_required装饰器**：租户权限验证装饰器
- **role_required装饰器**：角色权限验证装饰器
- **super_admin_required装饰器**：超级管理员权限验证装饰器

#### **app/utils/agent_auth.py** - Agent认证工具
- **verify_agent_token方法**：验证Agent令牌
- **generate_agent_token方法**：生成Agent令牌

#### **app/utils/quota_checker.py** - 配额检查工具
- **check_tenant_quota方法**：检查租户配额
- **QuotaChecker类**：配额检查器

#### **app/utils/tenant_context.py** - 租户上下文工具
- **TenantContext类**：租户上下文管理器

### 7. 定时任务调度（scheduler.py）
- **check_node_status函数**：每5分钟检查节点状态
  - 检测超时未发送心跳的节点（5分钟超时）
  - 自动将超时节点标记为离线
  - 记录状态变更日志
- **push_daily_reports函数**：推送每日报表
- **push_weekly_reports函数**：推送每周报表
- **push_monthly_reports函数**：推送每月报表
- **start_scheduler函数**：启动后台调度器
  - 使用APScheduler的BackgroundScheduler
  - 配置节点状态检查任务
  - 配置报表推送任务
  - 提供优雅启停机制

### 8. 数据库迁移（alembic/）

#### **alembic/env.py** - Alembic环境配置
- 配置数据库连接和模型元数据
- 支持在线和离线迁移模式
- 自动发现模型变更

#### **alembic/versions/** - 数据库迁移脚本目录
- **90bd0f2b680b_initial_migration.py**：初始迁移，创建用户表
- **144610be5f76_add_tasks_and_results_tables.py**：添加任务和结果表
- **0002_add_nodes_table.py**：添加节点表
- **0003_add_agent_ids_to_tasks.py**：为任务表添加agent_ids字段
- **0004_add_agent_info_to_results.py**：为结果表添加agent信息字段
- **0005_add_system_variables_table.py**：添加系统变量表
- **0006_add_cascade_delete_to_results.py**：为结果表添加级联删除约束
- **0007_add_alerts_tables.py**：添加告警相关表
- **0008_add_reports_tables.py**：添加报表相关表
- **0009_add_multi_tenant_support.py**：添加多租户支持
- **0009_merge_heads.py**：合并迁移头
- **0010_add_enhanced_alert_config_fields.py**：添加增强告警配置字段
- **3c6bef228603_merge_migrations.py**：合并迁移
- **840c1438c4b7_merge_heads_and_add_trigger_fields.py**：合并头并添加触发字段
- **8e9daf1b9ddf_add_soft_delete_to_system_variables.py**：为系统变量添加软删除
- **ae128c8996b1_merge_multi_tenant_and_existing_heads.py**：合并多租户和现有头

### 9. 辅助脚本

#### **scripts/migrate_to_multi_tenant.py** - 多租户迁移脚本
- 功能：将现有数据迁移到多租户架构
- 实现：为现有数据分配默认租户

#### **update_foreign_key.py** - 外键更新脚本
- 功能：为已存在的数据库表添加外键约束
- 实现：通过创建新表、迁移数据、删除旧表、重命名新表的方式实现
- 使用：在数据库结构更新后执行

#### **remove_node_tenant_binding.py** - 移除节点租户绑定脚本
- 功能：移除节点与租户的绑定关系
- 实现：更新节点表结构，使节点成为全局共享资源

### 10. 日志配置

#### **logging.conf** - 日志配置文件
- 配置日志输出格式、级别和目标
- 支持文件和控制台输出

#### **logging_config.py** - 日志配置类
- **LoggingConfig类**：日志配置管理器
- 支持从配置文件加载日志配置

### 11. 部署配置

#### **Dockerfile** - 后端容器化配置
- **基础镜像**：python:3.11-slim（轻量级Python 3.11）
- **工作目录**：/app
- **依赖安装**：复制requirements.txt并安装所有依赖
- **端口暴露**：5001端口
- **启动命令**：python run.py

#### **alembic.ini** - 数据库迁移配置
- 配置Alembic数据库迁移工具
- 支持数据库版本管理和结构变更
- 预留生产环境数据库升级能力

## 技术栈总结
- **后端框架**：Flask + Flask-SQLAlchemy
- **数据库**：SQLite（开发环境）/ MySQL（生产环境可扩展）
- **认证**：JWT令牌认证
- **调度**：APScheduler定时任务
- **容器化**：Docker容器化部署
- **API风格**：RESTful API设计
- **跨域**：CORS支持前后端分离
- **数据库迁移**：Alembic数据库版本管理
- **多租户**：基于租户ID的多租户架构

## 开发环境启动步骤
1. **安装依赖**：`pip install -r app/requirements.txt`
2. **初始化数据库**：`python init_db.py`
3. **启动服务**：`python run.py`
4. **访问API**：http://localhost:5001/api/v1/health

## 项目特色
- **模块化设计**：清晰的MVC架构，易于维护和扩展
- **RESTful API**：标准的HTTP接口设计，支持前后端分离
- **JWT认证**：安全的用户认证机制
- **定时任务**：自动化的节点状态监控和报表推送
- **多节点支持**：分布式拨测架构设计
- **API测试功能**：支持多步骤API接口测试
- **系统变量管理**：支持在API测试中使用系统变量
- **容器化部署**：支持Docker快速部署
- **数据完整性**：外键约束和事务处理保证数据一致性
- **数据库迁移**：使用Alembic管理数据库结构变更
- **多租户架构**：支持多租户隔离和资源配额管理
- **完善的告警系统**：支持多种告警类型和灵活的告警规则配置
- **报表功能**：支持多种格式的报表生成和定时推送