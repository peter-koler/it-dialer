2025-08-31 09:00:32 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:00:32 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:00:32 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:00:32 - app.services.alert_matcher - INFO - alert_matcher.py:974 - 开始检查TCP任务告警配置 - 任务ID: 19
2025-08-31 09:00:32 - app.services.alert_matcher - INFO - alert_matcher.py:978 - TCP告警配置内容: {'enabled': False, 'rules': {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': False, 'level': 'warning'}}}
2025-08-31 09:00:32 - app.services.alert_matcher - INFO - alert_matcher.py:981 - TCP告警配置未启用或为空，跳过检查
2025-08-31 09:00:32 - app.services.alert_matcher - INFO - alert_matcher.py:131 - TCP告警配置检查结果: 0 个告警
2025-08-31 09:00:32 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 0 个告警
2025-08-31 09:00:32 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:00:32] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:01:03 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:01:03] "OPTIONS /api/v1/nodes HTTP/1.1" 200 -
2025-08-31 09:01:03 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:01:03] "GET /api/v1/nodes HTTP/1.1" 200 -
2025-08-31 09:01:16 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:01:16] "OPTIONS /api/v2/tasks/19 HTTP/1.1" 200 -
2025-08-31 09:01:16 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:01:16] "PUT /api/v2/tasks/19 HTTP/1.1" 200 -
2025-08-31 09:01:22 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:01:22] "OPTIONS /api/v1/alerts?page=1&per_page=20&task_name= HTTP/1.1" 200 -
2025-08-31 09:01:22 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:01:22] "GET /api/v1/alerts?page=1&per_page=20&task_name= HTTP/1.1" 200 -
2025-08-31 09:01:36 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:01:36] "OPTIONS /api/v1/nodes HTTP/1.1" 200 -
2025-08-31 09:01:36 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:01:36] "OPTIONS /api/v2/tasks?page=1&size=20 HTTP/1.1" 200 -
2025-08-31 09:01:36 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:01:36] "GET /api/v1/nodes HTTP/1.1" 200 -
2025-08-31 09:01:36 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:01:36] "GET /api/v2/tasks?page=1&size=20 HTTP/1.1" 200 -
2025-08-31 09:01:38 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:01:38] "OPTIONS /api/v2/tasks/19 HTTP/1.1" 200 -
2025-08-31 09:01:38 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:01:38] "PUT /api/v2/tasks/19 HTTP/1.1" 200 -
2025-08-31 09:01:39 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:01:39] "GET /api/v1/nodes HTTP/1.1" 200 -
2025-08-31 09:01:45 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:01:45] "OPTIONS /api/v1/tasks/19 HTTP/1.1" 200 -
2025-08-31 09:01:45 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:01:45] "PUT /api/v1/tasks/19 HTTP/1.1" 200 -
2025-08-31 09:01:45 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:01:45] "OPTIONS /api/v2/tasks?page=1&size=20 HTTP/1.1" 200 -
2025-08-31 09:01:45 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:01:45] "GET /api/v2/tasks?page=1&size=20 HTTP/1.1" 200 -
2025-08-31 09:01:52 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:01:52] "[35m[1mPOST /api/v1/nodes/register HTTP/1.1[0m" 201 -
2025-08-31 09:01:52 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:01:52] "[35m[1mPOST /api/v1/nodes/register HTTP/1.1[0m" 201 -
2025-08-31 09:01:52 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:01:52] "POST /api/v1/nodes/heartbeat HTTP/1.1" 200 -
2025-08-31 09:01:52 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:01:52] "GET /api/v1/tasks/agent?enabled=true&agent_id=book HTTP/1.1" 200 -
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 19, 任务名称: openapi
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 19, 'status': 'failed', 'response_time': 0.00033092498779296875, 'message': '连接失败，返回码: 61', 'details': {'status': 'failed', 'connected': False, 'target': 'localhost:8080', 'host': 'localhost', 'port': 8080, 'execution_time': 0.00033092498779296875, 'return_code': 61, 'message': '连接失败，返回码: 61'}, 'created_at': '2025-08-31T09:01:52.558787', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'timeout': 5}
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: tcp
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 19
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'timeout': 5}
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: []
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:382 - 未配置任务状态告警
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:974 - 开始检查TCP任务告警配置 - 任务ID: 19
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:978 - TCP告警配置内容: {'enabled': True, 'rules': {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}}
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:985 - TCP告警规则: {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:1025 - 检查TCP状态告警 - 任务ID: 19
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:1032 - 任务状态: failed, 告警条件: 异常
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:1042 - TCP状态告警触发: 状态=failed, 条件=异常
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 19, 类型: tcp_status, 级别: warning
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: TCP状态告警 - openapi
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: TCP任务状态为 failed，触发告警条件: 异常
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 451 字符
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 83, 类型: tcp_status, 级别: warning
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:131 - TCP告警配置检查结果: 1 个告警
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 1 个告警
2025-08-31 09:01:52 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 1: 类型=tcp_status, 级别=warning, 标题=TCP状态告警 - openapi
2025-08-31 09:01:52 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:01:52] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:02:02 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:02:02] "OPTIONS /api/v1/alerts?page=1&per_page=20&task_name= HTTP/1.1" 200 -
2025-08-31 09:02:02 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:02:02] "GET /api/v1/alerts?page=1&per_page=20&task_name= HTTP/1.1" 200 -
2025-08-31 09:02:34 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:02:34] "OPTIONS /api/v1/alerts?page=1&per_page=20&task_name= HTTP/1.1" 200 -
2025-08-31 09:02:34 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:02:34] "GET /api/v1/alerts?page=1&per_page=20&task_name= HTTP/1.1" 200 -
2025-08-31 09:02:52 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:02:52] "GET /api/v1/tasks/agent?enabled=true&agent_id=book HTTP/1.1" 200 -
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 19, 任务名称: openapi
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 19, 'status': 'failed', 'response_time': 0.00039386749267578125, 'message': '连接失败，返回码: 61', 'details': {'status': 'failed', 'connected': False, 'target': 'localhost:8080', 'host': 'localhost', 'port': 8080, 'execution_time': 0.00039386749267578125, 'return_code': 61, 'message': '连接失败，返回码: 61'}, 'created_at': '2025-08-31T09:02:52.623307', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'timeout': 5}
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: tcp
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 19
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'timeout': 5}
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: []
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:382 - 未配置任务状态告警
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:974 - 开始检查TCP任务告警配置 - 任务ID: 19
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:978 - TCP告警配置内容: {'enabled': True, 'rules': {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}}
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:985 - TCP告警规则: {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:1025 - 检查TCP状态告警 - 任务ID: 19
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:1032 - 任务状态: failed, 告警条件: 异常
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:1042 - TCP状态告警触发: 状态=failed, 条件=异常
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 19, 类型: tcp_status, 级别: warning
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: TCP状态告警 - openapi
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: TCP任务状态为 failed，触发告警条件: 异常
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 451 字符
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 84, 类型: tcp_status, 级别: warning
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:131 - TCP告警配置检查结果: 1 个告警
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 1 个告警
2025-08-31 09:02:52 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 1: 类型=tcp_status, 级别=warning, 标题=TCP状态告警 - openapi
2025-08-31 09:02:52 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:02:52] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:03:52 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:03:52] "GET /api/v1/tasks/agent?enabled=true&agent_id=book HTTP/1.1" 200 -
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 19, 任务名称: openapi
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 19, 'status': 'failed', 'response_time': 0.00042700767517089844, 'message': '连接失败，返回码: 61', 'details': {'status': 'failed', 'connected': False, 'target': 'localhost:8080', 'host': 'localhost', 'port': 8080, 'execution_time': 0.00042700767517089844, 'return_code': 61, 'message': '连接失败，返回码: 61'}, 'created_at': '2025-08-31T09:03:52.682178', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'timeout': 5}
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: tcp
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 19
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'timeout': 5}
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: []
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:382 - 未配置任务状态告警
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:974 - 开始检查TCP任务告警配置 - 任务ID: 19
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:978 - TCP告警配置内容: {'enabled': True, 'rules': {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}}
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:985 - TCP告警规则: {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:1025 - 检查TCP状态告警 - 任务ID: 19
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:1032 - 任务状态: failed, 告警条件: 异常
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:1042 - TCP状态告警触发: 状态=failed, 条件=异常
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 19, 类型: tcp_status, 级别: warning
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: TCP状态告警 - openapi
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: TCP任务状态为 failed，触发告警条件: 异常
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 451 字符
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 85, 类型: tcp_status, 级别: warning
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:131 - TCP告警配置检查结果: 1 个告警
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 1 个告警
2025-08-31 09:03:52 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 1: 类型=tcp_status, 级别=warning, 标题=TCP状态告警 - openapi
2025-08-31 09:03:52 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:03:52] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:04:34 - apscheduler.scheduler - DEBUG - base.py:954 - Looking for jobs to run
2025-08-31 09:04:34 - apscheduler.scheduler - DEBUG - base.py:1034 - Next wakeup is due at 2025-08-31 09:09:34.934184+08:00 (in 299.997677 seconds)
2025-08-31 09:04:34 - apscheduler.executors.default - INFO - base.py:123 - Running job "start_scheduler.<locals>.<lambda> (trigger: interval[0:05:00], next run at: 2025-08-31 09:09:34 CST)" (scheduled at 2025-08-31 09:04:34.934184+08:00)
2025-08-31 09:04:34 - apscheduler.executors.default - INFO - base.py:144 - Job "start_scheduler.<locals>.<lambda> (trigger: interval[0:05:00], next run at: 2025-08-31 09:09:34 CST)" executed successfully
2025-08-31 09:04:52 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:04:52] "GET /api/v1/tasks/agent?enabled=true&agent_id=book HTTP/1.1" 200 -
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 19, 任务名称: openapi
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 19, 'status': 'failed', 'response_time': 0.0004911422729492188, 'message': '连接失败，返回码: 61', 'details': {'status': 'failed', 'connected': False, 'target': 'localhost:8080', 'host': 'localhost', 'port': 8080, 'execution_time': 0.0004911422729492188, 'return_code': 61, 'message': '连接失败，返回码: 61'}, 'created_at': '2025-08-31T09:04:52.742609', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'timeout': 5}
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: tcp
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 19
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'timeout': 5}
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: []
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:382 - 未配置任务状态告警
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:974 - 开始检查TCP任务告警配置 - 任务ID: 19
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:978 - TCP告警配置内容: {'enabled': True, 'rules': {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}}
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:985 - TCP告警规则: {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:1025 - 检查TCP状态告警 - 任务ID: 19
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:1032 - 任务状态: failed, 告警条件: 异常
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:1042 - TCP状态告警触发: 状态=failed, 条件=异常
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 19, 类型: tcp_status, 级别: warning
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: TCP状态告警 - openapi
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: TCP任务状态为 failed，触发告警条件: 异常
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 449 字符
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 86, 类型: tcp_status, 级别: warning
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:131 - TCP告警配置检查结果: 1 个告警
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 1 个告警
2025-08-31 09:04:52 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 1: 类型=tcp_status, 级别=warning, 标题=TCP状态告警 - openapi
2025-08-31 09:04:52 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:04:52] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:05:26 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:05:26] "OPTIONS /api/v1/alerts?page=1&per_page=20&task_name= HTTP/1.1" 200 -
2025-08-31 09:05:26 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:05:26] "GET /api/v1/alerts?page=1&per_page=20&task_name= HTTP/1.1" 200 -
2025-08-31 09:05:48 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:05:48] "OPTIONS /api/v1/alerts?page=1&per_page=20&task_name= HTTP/1.1" 200 -
2025-08-31 09:05:48 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:05:48] "GET /api/v1/alerts?page=1&per_page=20&task_name= HTTP/1.1" 200 -
2025-08-31 09:05:52 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:05:52] "GET /api/v1/tasks/agent?enabled=true&agent_id=book HTTP/1.1" 200 -
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 19, 任务名称: openapi
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 19, 'status': 'failed', 'response_time': 0.0006189346313476562, 'message': '连接失败，返回码: 61', 'details': {'status': 'failed', 'connected': False, 'target': 'localhost:8080', 'host': 'localhost', 'port': 8080, 'execution_time': 0.0006189346313476562, 'return_code': 61, 'message': '连接失败，返回码: 61'}, 'created_at': '2025-08-31T09:05:52.814870', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'timeout': 5}
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: tcp
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 19
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'timeout': 5}
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: []
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:382 - 未配置任务状态告警
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:974 - 开始检查TCP任务告警配置 - 任务ID: 19
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:978 - TCP告警配置内容: {'enabled': True, 'rules': {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}}
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:985 - TCP告警规则: {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:1025 - 检查TCP状态告警 - 任务ID: 19
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:1032 - 任务状态: failed, 告警条件: 异常
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:1042 - TCP状态告警触发: 状态=failed, 条件=异常
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 19, 类型: tcp_status, 级别: warning
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: TCP状态告警 - openapi
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: TCP任务状态为 failed，触发告警条件: 异常
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 449 字符
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 87, 类型: tcp_status, 级别: warning
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:131 - TCP告警配置检查结果: 1 个告警
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 1 个告警
2025-08-31 09:05:52 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 1: 类型=tcp_status, 级别=warning, 标题=TCP状态告警 - openapi
2025-08-31 09:05:52 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:05:52] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:06:16 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:16] "OPTIONS /api/v1/alerts?page=1&per_page=20&task_name= HTTP/1.1" 200 -
2025-08-31 09:06:16 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:16] "GET /api/v1/alerts?page=1&per_page=20&task_name= HTTP/1.1" 200 -
2025-08-31 09:06:25 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:25] "OPTIONS /api/v1/nodes HTTP/1.1" 200 -
2025-08-31 09:06:25 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:25] "OPTIONS /api/v2/tasks?page=1&size=20 HTTP/1.1" 200 -
2025-08-31 09:06:25 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:25] "GET /api/v1/nodes HTTP/1.1" 200 -
2025-08-31 09:06:25 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:25] "GET /api/v2/tasks?page=1&size=20 HTTP/1.1" 200 -
2025-08-31 09:06:29 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:29] "OPTIONS /api/v1/alerts?page=1&per_page=20&task_name= HTTP/1.1" 200 -
2025-08-31 09:06:29 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:29] "GET /api/v1/alerts?page=1&per_page=20&task_name= HTTP/1.1" 200 -
2025-08-31 09:06:36 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:36] "OPTIONS /api/v1/nodes?page=1&size=10 HTTP/1.1" 200 -
2025-08-31 09:06:36 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:36] "GET /api/v1/nodes?page=1&size=10 HTTP/1.1" 200 -
2025-08-31 09:06:38 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:38] "OPTIONS /api/v1/nodes HTTP/1.1" 200 -
2025-08-31 09:06:38 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:38] "OPTIONS /api/v2/tasks?page=1&size=20 HTTP/1.1" 200 -
2025-08-31 09:06:38 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:38] "GET /api/v1/nodes HTTP/1.1" 200 -
2025-08-31 09:06:38 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:38] "GET /api/v2/tasks?page=1&size=20 HTTP/1.1" 200 -
2025-08-31 09:06:41 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:41] "OPTIONS /api/v2/results?page=1&size=10&start=2025-08-31+00:00:00&end=2025-08-31+23:59:59 HTTP/1.1" 200 -
2025-08-31 09:06:41 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:41] "GET /api/v2/results?page=1&size=10&start=2025-08-31+00:00:00&end=2025-08-31+23:59:59 HTTP/1.1" 200 -
2025-08-31 09:06:42 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:42] "OPTIONS /api/v2/results?task_id=19&start=2025-08-31T08:06:42%2B08:00&end=2025-08-31T09:06:42%2B08:00 HTTP/1.1" 200 -
2025-08-31 09:06:42 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:42] "OPTIONS /api/v2/results?task_id=19&start=2025-08-31T08:06:42%2B08:00&end=2025-08-31T09:06:42%2B08:00 HTTP/1.1" 200 -
2025-08-31 09:06:42 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:42] "GET /api/v2/results?task_id=19&start=2025-08-31T08:06:42%2B08:00&end=2025-08-31T09:06:42%2B08:00 HTTP/1.1" 200 -
2025-08-31 09:06:42 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:42] "GET /api/v2/results?task_id=19&start=2025-08-31T08:06:42%2B08:00&end=2025-08-31T09:06:42%2B08:00 HTTP/1.1" 200 -
2025-08-31 09:06:43 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:43] "OPTIONS /api/v1/alerts?page=1&per_page=10 HTTP/1.1" 200 -
2025-08-31 09:06:43 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:43] "OPTIONS /api/v1/tasks/19 HTTP/1.1" 200 -
2025-08-31 09:06:43 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:43] "GET /api/v1/alerts?page=1&per_page=10 HTTP/1.1" 200 -
2025-08-31 09:06:43 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:43] "GET /api/v1/tasks/19 HTTP/1.1" 200 -
2025-08-31 09:06:43 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:43] "OPTIONS /api/v1/tasks/19/results/aggregated?type=tcp&page=1&size=100 HTTP/1.1" 200 -
2025-08-31 09:06:44 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:06:44] "GET /api/v1/tasks/19/results/aggregated?type=tcp&page=1&size=100 HTTP/1.1" 200 -
2025-08-31 09:08:19 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:08:19] "[31m[1mPOST /api/v1/auth/login HTTP/1.1[0m" 401 -
2025-08-31 09:08:20 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:08:20] "[31m[1mPOST /api/v1/auth/login HTTP/1.1[0m" 401 -
2025-08-31 09:09:34 - apscheduler.scheduler - DEBUG - base.py:954 - Looking for jobs to run
2025-08-31 09:09:34 - apscheduler.scheduler - DEBUG - base.py:1034 - Next wakeup is due at 2025-08-31 09:09:34.934184+08:00 (in 0.000072 seconds)
2025-08-31 09:09:34 - apscheduler.scheduler - DEBUG - base.py:954 - Looking for jobs to run
2025-08-31 09:09:34 - apscheduler.scheduler - DEBUG - base.py:1034 - Next wakeup is due at 2025-08-31 09:14:34.934184+08:00 (in 299.999229 seconds)
2025-08-31 09:09:34 - apscheduler.executors.default - INFO - base.py:123 - Running job "start_scheduler.<locals>.<lambda> (trigger: interval[0:05:00], next run at: 2025-08-31 09:14:34 CST)" (scheduled at 2025-08-31 09:09:34.934184+08:00)
2025-08-31 09:09:34 - apscheduler.executors.default - INFO - base.py:144 - Job "start_scheduler.<locals>.<lambda> (trigger: interval[0:05:00], next run at: 2025-08-31 09:14:34 CST)" executed successfully
2025-08-31 09:10:50 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:10:50] "OPTIONS /api/v1/alerts?page=1&per_page=10 HTTP/1.1" 200 -
2025-08-31 09:10:50 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:10:50] "GET /api/v1/alerts?page=1&per_page=10 HTTP/1.1" 200 -
2025-08-31 09:11:03 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:11:03] "OPTIONS /api/v2/results?page=1&size=10&start=2025-08-31+00:00:00&end=2025-08-31+23:59:59 HTTP/1.1" 200 -
2025-08-31 09:11:03 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:11:03] "GET /api/v2/results?page=1&size=10&start=2025-08-31+00:00:00&end=2025-08-31+23:59:59 HTTP/1.1" 200 -
2025-08-31 09:11:05 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:11:05] "OPTIONS /api/v2/results?task_id=19&start=2025-08-31T08:11:05%2B08:00&end=2025-08-31T09:11:05%2B08:00 HTTP/1.1" 200 -
2025-08-31 09:11:05 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:11:05] "OPTIONS /api/v2/results?task_id=19&start=2025-08-31T08:11:05%2B08:00&end=2025-08-31T09:11:05%2B08:00 HTTP/1.1" 200 -
2025-08-31 09:11:05 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:11:05] "GET /api/v2/results?task_id=19&start=2025-08-31T08:11:05%2B08:00&end=2025-08-31T09:11:05%2B08:00 HTTP/1.1" 200 -
2025-08-31 09:11:05 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:11:05] "OPTIONS /api/v1/alerts?page=1&per_page=10 HTTP/1.1" 200 -
2025-08-31 09:11:05 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:11:05] "OPTIONS /api/v1/tasks/19 HTTP/1.1" 200 -
2025-08-31 09:11:05 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:11:05] "GET /api/v1/alerts?page=1&per_page=10 HTTP/1.1" 200 -
2025-08-31 09:11:05 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:11:05] "GET /api/v1/tasks/19 HTTP/1.1" 200 -
2025-08-31 09:11:05 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:11:05] "GET /api/v2/results?task_id=19&start=2025-08-31T08:11:05%2B08:00&end=2025-08-31T09:11:05%2B08:00 HTTP/1.1" 200 -
2025-08-31 09:11:06 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:11:06] "OPTIONS /api/v1/tasks/19/results/aggregated?type=tcp&page=1&size=100 HTTP/1.1" 200 -
2025-08-31 09:11:06 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:11:06] "GET /api/v1/tasks/19/results/aggregated?type=tcp&page=1&size=100 HTTP/1.1" 200 -
2025-08-31 09:11:14 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:11:14] "OPTIONS /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:11:15 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:11:15] "GET /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:14:34 - apscheduler.scheduler - DEBUG - base.py:954 - Looking for jobs to run
2025-08-31 09:14:34 - apscheduler.scheduler - DEBUG - base.py:1034 - Next wakeup is due at 2025-08-31 09:14:34.934184+08:00 (in 0.001360 seconds)
2025-08-31 09:14:34 - apscheduler.scheduler - DEBUG - base.py:954 - Looking for jobs to run
2025-08-31 09:14:34 - apscheduler.scheduler - DEBUG - base.py:1034 - Next wakeup is due at 2025-08-31 09:19:34.934184+08:00 (in 299.998520 seconds)
2025-08-31 09:14:34 - apscheduler.executors.default - INFO - base.py:123 - Running job "start_scheduler.<locals>.<lambda> (trigger: interval[0:05:00], next run at: 2025-08-31 09:19:34 CST)" (scheduled at 2025-08-31 09:14:34.934184+08:00)
2025-08-31 09:14:34 - apscheduler.executors.default - INFO - base.py:144 - Job "start_scheduler.<locals>.<lambda> (trigger: interval[0:05:00], next run at: 2025-08-31 09:19:34 CST)" executed successfully
2025-08-31 09:19:34 - apscheduler.scheduler - DEBUG - base.py:954 - Looking for jobs to run
2025-08-31 09:19:34 - apscheduler.scheduler - DEBUG - base.py:1034 - Next wakeup is due at 2025-08-31 09:19:34.934184+08:00 (in 0.001166 seconds)
2025-08-31 09:19:34 - apscheduler.scheduler - DEBUG - base.py:954 - Looking for jobs to run
2025-08-31 09:19:34 - apscheduler.scheduler - DEBUG - base.py:1034 - Next wakeup is due at 2025-08-31 09:24:34.934184+08:00 (in 299.998678 seconds)
2025-08-31 09:19:34 - apscheduler.executors.default - INFO - base.py:123 - Running job "start_scheduler.<locals>.<lambda> (trigger: interval[0:05:00], next run at: 2025-08-31 09:24:34 CST)" (scheduled at 2025-08-31 09:19:34.934184+08:00)
2025-08-31 09:19:34 - apscheduler.executors.default - INFO - base.py:144 - Job "start_scheduler.<locals>.<lambda> (trigger: interval[0:05:00], next run at: 2025-08-31 09:24:34 CST)" executed successfully
2025-08-31 09:24:24 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:24:24] "OPTIONS /api/v1/nodes HTTP/1.1" 200 -
2025-08-31 09:24:24 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:24:24] "OPTIONS /api/v2/tasks?page=1&size=20 HTTP/1.1" 200 -
2025-08-31 09:24:24 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:24:24] "GET /api/v1/nodes HTTP/1.1" 200 -
2025-08-31 09:24:24 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:24:24] "GET /api/v2/tasks?page=1&size=20 HTTP/1.1" 200 -
2025-08-31 09:24:34 - apscheduler.scheduler - DEBUG - base.py:954 - Looking for jobs to run
2025-08-31 09:24:34 - apscheduler.scheduler - DEBUG - base.py:1034 - Next wakeup is due at 2025-08-31 09:29:34.934184+08:00 (in 299.940632 seconds)
2025-08-31 09:24:34 - apscheduler.executors.default - INFO - base.py:123 - Running job "start_scheduler.<locals>.<lambda> (trigger: interval[0:05:00], next run at: 2025-08-31 09:29:34 CST)" (scheduled at 2025-08-31 09:24:34.934184+08:00)
2025-08-31 09:24:34 - apscheduler.executors.default - INFO - base.py:144 - Job "start_scheduler.<locals>.<lambda> (trigger: interval[0:05:00], next run at: 2025-08-31 09:29:34 CST)" executed successfully
2025-08-31 09:24:36 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:24:36] "OPTIONS /api/v2/results?page=1&size=10&start=2025-08-31+00:00:00&end=2025-08-31+23:59:59 HTTP/1.1" 200 -
2025-08-31 09:24:36 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:24:36] "GET /api/v2/results?page=1&size=10&start=2025-08-31+00:00:00&end=2025-08-31+23:59:59 HTTP/1.1" 200 -
2025-08-31 09:24:38 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:24:38] "OPTIONS /api/v2/results?task_id=19&start=2025-08-31T08:24:38%2B08:00&end=2025-08-31T09:24:38%2B08:00 HTTP/1.1" 200 -
2025-08-31 09:24:38 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:24:38] "OPTIONS /api/v2/results?task_id=19&start=2025-08-31T08:24:38%2B08:00&end=2025-08-31T09:24:38%2B08:00 HTTP/1.1" 200 -
2025-08-31 09:24:38 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:24:38] "GET /api/v2/results?task_id=19&start=2025-08-31T08:24:38%2B08:00&end=2025-08-31T09:24:38%2B08:00 HTTP/1.1" 200 -
2025-08-31 09:24:38 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:24:38] "GET /api/v2/results?task_id=19&start=2025-08-31T08:24:38%2B08:00&end=2025-08-31T09:24:38%2B08:00 HTTP/1.1" 200 -
2025-08-31 09:24:38 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:24:38] "OPTIONS /api/v1/alerts?page=1&per_page=10 HTTP/1.1" 200 -
2025-08-31 09:24:38 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:24:38] "OPTIONS /api/v1/tasks/19 HTTP/1.1" 200 -
2025-08-31 09:24:38 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:24:38] "GET /api/v1/alerts?page=1&per_page=10 HTTP/1.1" 200 -
2025-08-31 09:24:38 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:24:38] "GET /api/v1/tasks/19 HTTP/1.1" 200 -
2025-08-31 09:24:39 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:24:39] "OPTIONS /api/v1/tasks/19/results/aggregated?type=tcp&page=1&size=100 HTTP/1.1" 200 -
2025-08-31 09:24:39 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:24:39] "GET /api/v1/tasks/19/results/aggregated?type=tcp&page=1&size=100 HTTP/1.1" 200 -
2025-08-31 09:24:49 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:24:49] "OPTIONS /api/v2/results?page=1&size=10&start=2025-08-31+00:00:00&end=2025-08-31+23:59:59 HTTP/1.1" 200 -
2025-08-31 09:24:49 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:24:49] "GET /api/v2/results?page=1&size=10&start=2025-08-31+00:00:00&end=2025-08-31+23:59:59 HTTP/1.1" 200 -
2025-08-31 09:24:52 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:24:52] "OPTIONS /api/v1/nodes HTTP/1.1" 200 -
2025-08-31 09:24:52 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:24:52] "OPTIONS /api/v2/tasks?page=1&size=20 HTTP/1.1" 200 -
2025-08-31 09:24:53 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:24:53] "GET /api/v1/nodes HTTP/1.1" 200 -
2025-08-31 09:24:53 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:24:53] "GET /api/v2/tasks?page=1&size=20 HTTP/1.1" 200 -
2025-08-31 09:25:04 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:25:04] "OPTIONS /api/v2/tasks/18 HTTP/1.1" 200 -
2025-08-31 09:25:04 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:25:04] "PUT /api/v2/tasks/18 HTTP/1.1" 200 -
2025-08-31 09:25:07 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:25:07] "OPTIONS /api/v2/tasks/17 HTTP/1.1" 200 -
2025-08-31 09:25:07 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:25:07] "PUT /api/v2/tasks/17 HTTP/1.1" 200 -
2025-08-31 09:25:09 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:25:09] "OPTIONS /api/v2/tasks/18 HTTP/1.1" 200 -
2025-08-31 09:25:09 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:25:09] "PUT /api/v2/tasks/18 HTTP/1.1" 200 -
2025-08-31 09:25:11 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:25:11] "OPTIONS /api/v2/tasks/15 HTTP/1.1" 200 -
2025-08-31 09:25:11 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:25:11] "PUT /api/v2/tasks/15 HTTP/1.1" 200 -
2025-08-31 09:25:14 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:25:14] "OPTIONS /api/v2/tasks/20 HTTP/1.1" 200 -
2025-08-31 09:25:14 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:25:14] "PUT /api/v2/tasks/20 HTTP/1.1" 200 -
2025-08-31 09:25:35 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:25:35] "OPTIONS /api/v1/nodes HTTP/1.1" 200 -
2025-08-31 09:25:35 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:25:35] "OPTIONS /api/v2/tasks/20 HTTP/1.1" 200 -
2025-08-31 09:25:35 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:25:35] "GET /api/v1/nodes HTTP/1.1" 200 -
2025-08-31 09:25:35 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:25:35] "GET /api/v2/tasks/20 HTTP/1.1" 200 -
2025-08-31 09:25:56 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:25:56] "OPTIONS /api/v2/tasks/20 HTTP/1.1" 200 -
2025-08-31 09:25:56 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:25:56] "PUT /api/v2/tasks/20 HTTP/1.1" 200 -
2025-08-31 09:25:56 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:25:56] "OPTIONS /api/v1/nodes HTTP/1.1" 200 -
2025-08-31 09:25:56 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:25:56] "OPTIONS /api/v2/tasks?page=1&size=20 HTTP/1.1" 200 -
2025-08-31 09:25:56 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:25:56] "GET /api/v1/nodes HTTP/1.1" 200 -
2025-08-31 09:25:56 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:25:56] "GET /api/v2/tasks?page=1&size=20 HTTP/1.1" 200 -
2025-08-31 09:26:15 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:26:15] "[35m[1mPOST /api/v1/nodes/register HTTP/1.1[0m" 201 -
2025-08-31 09:26:15 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:26:15] "[35m[1mPOST /api/v1/nodes/register HTTP/1.1[0m" 201 -
2025-08-31 09:26:15 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:26:15] "POST /api/v1/nodes/heartbeat HTTP/1.1" 200 -
2025-08-31 09:26:15 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:26:15] "GET /api/v1/tasks/agent?enabled=true&agent_id=book HTTP/1.1" 200 -
2025-08-31 09:26:15 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 15, 任务名称: ceshi1baidu
2025-08-31 09:26:15 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 15, 'status': 'success', 'response_time': None, 'message': 'HTTP请求成功，状态码: 200', 'details': {'status': 'success', 'response_time': 98.96302223205566, 'message': 'HTTP请求成功，状态码: 200', 'webstatus': '正常', 'details': {'dns_time': 20.36905288696289, 'tcp_time': 15.980005264282227, 'ssl_time': 0, 'first_byte_time': 36.79609298706055, 'download_time': 25.72798728942871, 'http_time': 62.61110305786133, 'status_code': 200, 'response_headers': {'Bdpagetype': '1', 'Bdqid': '0xa77b803b00e3d6bc', 'Connection': 'keep-alive', 'Content-Encoding': 'gzip', 'Content-Type': 'text/html; charset=utf-8', 'Date': 'Sun, 31 Aug 2025 01:26:15 GMT', 'P3p': 'CP=" OTI DSP COR IVA OUR IND COM ", CP=" OTI DSP COR IVA OUR IND COM "', 'Server': 'BWS/1.1', 'Set-Cookie': 'BAIDUID=47D8B5342DA2CD7621B1DBE261D4A448:FG=1; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, BIDUPSID=47D8B5342DA2CD7621B1DBE261D4A448; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, PSTM=1756603575; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, BAIDUID=47D8B5342DA2CD76A3B0E7B98B7A8487:FG=1; max-age=31536000; expires=Mon, 31-Aug-26 01:26:15 GMT; domain=.baidu.com; path=/; version=1; comment=bd, BDSVRTM=2; path=/, BD_HOME=1; path=/', 'Tr_id': 'super_0xa77b803b00e3d6bc', 'Traceid': '1756603575378635674612068380617375733436', 'X-Ua-Compatible': 'IE=Edge,chrome=1', 'X-Xss-Protection': '1;mode=block', 'Transfer-Encoding': 'chunked'}, 'content_length': 624182, 'dns_ips': ['183.240.99.169', '183.240.99.58'], 'final_url': 'http://www.baidu.com/'}}, 'created_at': '2025-08-31T09:26:15.179270', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:26:15 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {}
2025-08-31 09:26:15 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:26:15 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: http
2025-08-31 09:26:15 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:26:15 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:26:15 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:26:15 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 15
2025-08-31 09:26:15 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {}
2025-08-31 09:26:15 - app.services.alert_matcher - INFO - alert_matcher.py:364 - 任务配置为空，跳过任务配置告警检查
2025-08-31 09:26:15 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:26:15 - app.services.alert_matcher - INFO - alert_matcher.py:422 - 开始检查HTTP任务告警配置 - 任务ID: 15
2025-08-31 09:26:15 - app.services.alert_matcher - INFO - alert_matcher.py:426 - HTTP告警配置内容: {'enabled': False, 'rules': {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': False, 'level': 'warning'}}}
2025-08-31 09:26:15 - app.services.alert_matcher - INFO - alert_matcher.py:429 - HTTP告警配置未启用或为空，跳过检查
2025-08-31 09:26:15 - app.services.alert_matcher - INFO - alert_matcher.py:113 - HTTP告警配置检查结果: 0 个告警
2025-08-31 09:26:15 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 0 个告警
2025-08-31 09:26:15 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:26:15] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 17, 任务名称: 谷歌
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 17, 'status': 'failed', 'response_time': 14.04455280303955, 'message': '', 'details': {'status': 'failed', 'packet_sent': 4, 'packet_received': 0, 'packet_loss': 100.0, 'rtt_min': 0, 'rtt_avg': 0, 'rtt_max': 0, 'execution_time': 14.04455280303955, 'target': 'www.google.com'}, 'created_at': '2025-08-31T09:26:29.246823', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'count': 4}
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: ping
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 17
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'count': 4}
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: []
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:382 - 未配置任务状态告警
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:735 - 开始检查Ping任务告警配置 - 任务ID: 17
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:739 - Ping告警配置内容: {'enabled': False, 'rules': {'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'status': {'condition': '异常', 'enabled': False, 'level': 'warning'}}}
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:742 - Ping告警配置未启用或为空，跳过检查
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:122 - Ping告警配置检查结果: 0 个告警
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 0 个告警
2025-08-31 09:26:29 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:26:29] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 19, 任务名称: openapi
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 19, 'status': 'failed', 'response_time': 0.0003409385681152344, 'message': '连接失败，返回码: 61', 'details': {'status': 'failed', 'connected': False, 'target': 'localhost:8080', 'host': 'localhost', 'port': 8080, 'execution_time': 0.0003409385681152344, 'return_code': 61, 'message': '连接失败，返回码: 61'}, 'created_at': '2025-08-31T09:26:29.272292', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'timeout': 5}
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: tcp
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 19
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'timeout': 5}
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: []
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:382 - 未配置任务状态告警
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:974 - 开始检查TCP任务告警配置 - 任务ID: 19
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:978 - TCP告警配置内容: {'enabled': True, 'rules': {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}}
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:985 - TCP告警规则: {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:1025 - 检查TCP状态告警 - 任务ID: 19
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:1032 - 任务状态: failed, 告警条件: 异常
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:1042 - TCP状态告警触发: 状态=failed, 条件=异常
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 19, 类型: tcp_status, 级别: warning
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: TCP状态告警 - openapi
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: TCP任务状态为 failed，触发告警条件: 异常
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 449 字符
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 88, 类型: tcp_status, 级别: warning
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:131 - TCP告警配置检查结果: 1 个告警
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 1 个告警
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 1: 类型=tcp_status, 级别=warning, 标题=TCP状态告警 - openapi
2025-08-31 09:26:29 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:26:29] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:26:29 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:26:29] "[31m[1mGET /api/v1/system-variables HTTP/1.1[0m" 401 -
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 20, 任务名称: ceshiapi
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 20, 'status': 'success', 'response_time': None, 'message': '成功完成所有 2 个步骤', 'details': {'status': 'success', 'response_time': 26.67, 'message': '成功完成所有 2 个步骤', 'details': {'steps': [{'step_id': 'step_1756514148453_ny5fx9xny', 'name': '获取 ip', 'status': 'success', 'response_time': 11.04, 'message': '步骤执行成功', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'response': {'status_code': 200, 'headers': {'Server': 'Werkzeug/2.3.7 Python/3.13.2', 'Date': 'Sun, 31 Aug 2025 01:26:29 GMT', 'Content-Type': 'application/json', 'Content-Length': '28', 'Connection': 'close'}, 'content_type': 'application/json', 'body': {'ip': '192.168.31.17'}, 'size': 28}, 'assertions': [], 'extractions': [{'source': 'json_body', 'expression': '$.ip', 'variable_name': '$ip', 'success': True, 'message': '成功提取变量', 'value': '192.168.31.17'}]}, {'step_id': 'step_1756514258232_h4uuugdzo', 'name': '获取名称', 'status': 'success', 'response_time': 7.64, 'message': '步骤执行成功', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '192.168.31.17'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '192.168.31.17'}]}, 'response': {'status_code': 200, 'headers': {'Server': 'Werkzeug/2.3.7 Python/3.13.2', 'Date': 'Sun, 31 Aug 2025 01:26:29 GMT', 'Content-Type': 'application/json', 'Content-Length': '31', 'Connection': 'close'}, 'content_type': 'application/json', 'body': {'hostname': 'peterdembp'}, 'size': 31}, 'assertions': [], 'extractions': []}], 'variables': {}, 'total_assertions': 0, 'passed_assertions': 0, 'start_time': '2025-08-31T09:26:29.292553', 'end_time': '2025-08-31T09:26:29.319228'}}, 'created_at': '2025-08-31T09:26:29.319412', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'steps': [{'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'warning'}, 'assertions': [], 'name': '获取 ip', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'step_id': 'step_1756514148453_ny5fx9xny', 'variables': [{'expression': '$.ip', 'name': '$ip', 'source': 'body'}]}, {'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'severe'}, 'assertions': [], 'name': '获取名称', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '$ip'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '$ip'}]}, 'step_id': 'step_1756514258232_h4uuugdzo', 'variables': []}], 'variables': [], 'authentication': {'accessToken': '', 'headers': [], 'keyName': '', 'keyValue': '', 'location': 'header', 'password': '', 'token': '', 'tokenType': 'Bearer', 'type': 'none', 'username': ''}, 'statusAlertConfig': ['failed'], 'timeoutAlertEnabled': False, 'timeoutThreshold': 5000}
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:70 - 使用嵌套的details结构，找到 2 个步骤
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: api
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: True
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:77 - steps数量: 2
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:165 - 开始检查API步骤告警 - 步骤数量: 2, 配置步骤数量: 2
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:169 - 处理步骤: step_1756514148453_ny5fx9xny
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514148453_ny5fx9xny, 配置=step_1756514148453_ny5fx9xny
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:178 - 找到匹配的步骤配置: step_1756514148453_ny5fx9xny
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 20, 类型: response_time, 级别: warning
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: 步骤 step_1756514148453_ny5fx9xny 响应时间超时
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: 响应时间 11040.00ms 超过阈值 5000.00ms
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 1953 字符
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 89, 类型: response_time, 级别: warning
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:169 - 处理步骤: step_1756514258232_h4uuugdzo
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514258232_h4uuugdzo, 配置=step_1756514148453_ny5fx9xny
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514258232_h4uuugdzo, 配置=step_1756514258232_h4uuugdzo
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:178 - 找到匹配的步骤配置: step_1756514258232_h4uuugdzo
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 20, 类型: response_time, 级别: warning
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: 步骤 step_1756514258232_h4uuugdzo 响应时间超时
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: 响应时间 7640.00ms 超过阈值 5000.00ms
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 1953 字符
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 90, 类型: response_time, 级别: warning
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:87 - API步骤告警检查结果: 2 个告警
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 20
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'steps': [{'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'warning'}, 'assertions': [], 'name': '获取 ip', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'step_id': 'step_1756514148453_ny5fx9xny', 'variables': [{'expression': '$.ip', 'name': '$ip', 'source': 'body'}]}, {'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'severe'}, 'assertions': [], 'name': '获取名称', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '$ip'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '$ip'}]}, 'step_id': 'step_1756514258232_h4uuugdzo', 'variables': []}], 'variables': [], 'authentication': {'accessToken': '', 'headers': [], 'keyName': '', 'keyValue': '', 'location': 'header', 'password': '', 'token': '', 'tokenType': 'Bearer', 'type': 'none', 'username': ''}, 'statusAlertConfig': ['failed'], 'timeoutAlertEnabled': False, 'timeoutThreshold': 5000}
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: ['failed']
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:372 - 开始检查任务状态告警，配置: ['failed']
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:1332 - 检查任务状态告警 - 任务ID: 20
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:1336 - Agent上报的任务状态: success
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:1337 - 状态告警配置: ['failed']
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:1375 - 任务状态 'success' 不在告警配置 ['failed'] 中，不触发告警
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:380 - 未触发任务状态告警
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 2 个告警
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 1: 类型=response_time, 级别=warning, 标题=步骤 step_1756514148453_ny5fx9xny 响应时间超时
2025-08-31 09:26:29 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 2: 类型=response_time, 级别=warning, 标题=步骤 step_1756514258232_h4uuugdzo 响应时间超时
2025-08-31 09:26:29 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:26:29] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:27:29 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:27:29] "GET /api/v1/tasks/agent?enabled=true&agent_id=book HTTP/1.1" 200 -
2025-08-31 09:27:29 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 15, 任务名称: ceshi1baidu
2025-08-31 09:27:29 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 15, 'status': 'success', 'response_time': None, 'message': 'HTTP请求成功，状态码: 200', 'details': {'status': 'success', 'response_time': 108.13498497009277, 'message': 'HTTP请求成功，状态码: 200', 'webstatus': '正常', 'details': {'dns_time': 7.408857345581055, 'tcp_time': 26.083946228027344, 'ssl_time': 0, 'first_byte_time': 41.996002197265625, 'download_time': 32.50408172607422, 'http_time': 74.63622093200684, 'status_code': 200, 'response_headers': {'Bdpagetype': '1', 'Bdqid': '0xd8778ef200ca4566', 'Connection': 'keep-alive', 'Content-Encoding': 'gzip', 'Content-Type': 'text/html; charset=utf-8', 'Date': 'Sun, 31 Aug 2025 01:27:29 GMT', 'P3p': 'CP=" OTI DSP COR IVA OUR IND COM ", CP=" OTI DSP COR IVA OUR IND COM "', 'Server': 'BWS/1.1', 'Set-Cookie': 'BAIDUID=8896901EC2D3A8E3FF7B372C842E6894:FG=1; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, BIDUPSID=8896901EC2D3A8E3FF7B372C842E6894; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, PSTM=1756603649; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, BAIDUID=8896901EC2D3A8E3FB898D1E1817050B:FG=1; max-age=31536000; expires=Mon, 31-Aug-26 01:27:29 GMT; domain=.baidu.com; path=/; version=1; comment=bd, BDSVRTM=2; path=/, BD_HOME=1; path=/', 'Tr_id': 'super_0xd8778ef200ca4566', 'Traceid': '1756603649350114407415598093004467488102', 'X-Ua-Compatible': 'IE=Edge,chrome=1', 'X-Xss-Protection': '1;mode=block', 'Transfer-Encoding': 'chunked'}, 'content_length': 624198, 'dns_ips': ['183.240.99.58', '183.240.99.169'], 'final_url': 'http://www.baidu.com/'}}, 'created_at': '2025-08-31T09:27:29.503071', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:27:29 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {}
2025-08-31 09:27:29 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:27:29 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: http
2025-08-31 09:27:29 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:27:29 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:27:29 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:27:29 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 15
2025-08-31 09:27:29 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {}
2025-08-31 09:27:29 - app.services.alert_matcher - INFO - alert_matcher.py:364 - 任务配置为空，跳过任务配置告警检查
2025-08-31 09:27:29 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:27:29 - app.services.alert_matcher - INFO - alert_matcher.py:422 - 开始检查HTTP任务告警配置 - 任务ID: 15
2025-08-31 09:27:29 - app.services.alert_matcher - INFO - alert_matcher.py:426 - HTTP告警配置内容: {'enabled': False, 'rules': {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': False, 'level': 'warning'}}}
2025-08-31 09:27:29 - app.services.alert_matcher - INFO - alert_matcher.py:429 - HTTP告警配置未启用或为空，跳过检查
2025-08-31 09:27:29 - app.services.alert_matcher - INFO - alert_matcher.py:113 - HTTP告警配置检查结果: 0 个告警
2025-08-31 09:27:29 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 0 个告警
2025-08-31 09:27:29 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:27:29] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:27:36 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:27:36] "OPTIONS /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:27:37 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:27:37] "GET /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 17, 任务名称: 谷歌
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 17, 'status': 'failed', 'response_time': 14.023255109786987, 'message': '', 'details': {'status': 'failed', 'packet_sent': 4, 'packet_received': 0, 'packet_loss': 100.0, 'rtt_min': 0, 'rtt_avg': 0, 'rtt_max': 0, 'execution_time': 14.023255109786987, 'target': 'www.google.com'}, 'created_at': '2025-08-31T09:27:43.552317', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'count': 4}
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: ping
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 17
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'count': 4}
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: []
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:382 - 未配置任务状态告警
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:735 - 开始检查Ping任务告警配置 - 任务ID: 17
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:739 - Ping告警配置内容: {'enabled': False, 'rules': {'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'status': {'condition': '异常', 'enabled': False, 'level': 'warning'}}}
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:742 - Ping告警配置未启用或为空，跳过检查
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:122 - Ping告警配置检查结果: 0 个告警
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 0 个告警
2025-08-31 09:27:43 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:27:43] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 19, 任务名称: openapi
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 19, 'status': 'failed', 'response_time': 0.0004649162292480469, 'message': '连接失败，返回码: 61', 'details': {'status': 'failed', 'connected': False, 'target': 'localhost:8080', 'host': 'localhost', 'port': 8080, 'execution_time': 0.0004649162292480469, 'return_code': 61, 'message': '连接失败，返回码: 61'}, 'created_at': '2025-08-31T09:27:43.582365', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'timeout': 5}
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: tcp
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 19
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'timeout': 5}
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: []
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:382 - 未配置任务状态告警
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:974 - 开始检查TCP任务告警配置 - 任务ID: 19
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:978 - TCP告警配置内容: {'enabled': True, 'rules': {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}}
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:985 - TCP告警规则: {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:1025 - 检查TCP状态告警 - 任务ID: 19
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:1032 - 任务状态: failed, 告警条件: 异常
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:1042 - TCP状态告警触发: 状态=failed, 条件=异常
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 19, 类型: tcp_status, 级别: warning
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: TCP状态告警 - openapi
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: TCP任务状态为 failed，触发告警条件: 异常
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 449 字符
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 91, 类型: tcp_status, 级别: warning
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:131 - TCP告警配置检查结果: 1 个告警
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 1 个告警
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 1: 类型=tcp_status, 级别=warning, 标题=TCP状态告警 - openapi
2025-08-31 09:27:43 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:27:43] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:27:43 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:27:43] "[31m[1mGET /api/v1/system-variables HTTP/1.1[0m" 401 -
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 20, 任务名称: ceshiapi
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 20, 'status': 'success', 'response_time': None, 'message': '成功完成所有 2 个步骤', 'details': {'status': 'success', 'response_time': 24.42, 'message': '成功完成所有 2 个步骤', 'details': {'steps': [{'step_id': 'step_1756514148453_ny5fx9xny', 'name': '获取 ip', 'status': 'success', 'response_time': 9.27, 'message': '步骤执行成功', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'response': {'status_code': 200, 'headers': {'Server': 'Werkzeug/2.3.7 Python/3.13.2', 'Date': 'Sun, 31 Aug 2025 01:27:43 GMT', 'Content-Type': 'application/json', 'Content-Length': '28', 'Connection': 'close'}, 'content_type': 'application/json', 'body': {'ip': '192.168.31.17'}, 'size': 28}, 'assertions': [], 'extractions': [{'source': 'json_body', 'expression': '$.ip', 'variable_name': '$ip', 'success': True, 'message': '成功提取变量', 'value': '192.168.31.17'}]}, {'step_id': 'step_1756514258232_h4uuugdzo', 'name': '获取名称', 'status': 'success', 'response_time': 8.17, 'message': '步骤执行成功', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '192.168.31.17'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '192.168.31.17'}]}, 'response': {'status_code': 200, 'headers': {'Server': 'Werkzeug/2.3.7 Python/3.13.2', 'Date': 'Sun, 31 Aug 2025 01:27:43 GMT', 'Content-Type': 'application/json', 'Content-Length': '31', 'Connection': 'close'}, 'content_type': 'application/json', 'body': {'hostname': 'peterdembp'}, 'size': 31}, 'assertions': [], 'extractions': []}], 'variables': {}, 'total_assertions': 0, 'passed_assertions': 0, 'start_time': '2025-08-31T09:27:43.610794', 'end_time': '2025-08-31T09:27:43.635224'}}, 'created_at': '2025-08-31T09:27:43.635439', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'steps': [{'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'warning'}, 'assertions': [], 'name': '获取 ip', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'step_id': 'step_1756514148453_ny5fx9xny', 'variables': [{'expression': '$.ip', 'name': '$ip', 'source': 'body'}]}, {'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'severe'}, 'assertions': [], 'name': '获取名称', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '$ip'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '$ip'}]}, 'step_id': 'step_1756514258232_h4uuugdzo', 'variables': []}], 'variables': [], 'authentication': {'accessToken': '', 'headers': [], 'keyName': '', 'keyValue': '', 'location': 'header', 'password': '', 'token': '', 'tokenType': 'Bearer', 'type': 'none', 'username': ''}, 'statusAlertConfig': ['failed'], 'timeoutAlertEnabled': False, 'timeoutThreshold': 5000}
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:70 - 使用嵌套的details结构，找到 2 个步骤
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: api
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: True
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:77 - steps数量: 2
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:165 - 开始检查API步骤告警 - 步骤数量: 2, 配置步骤数量: 2
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:169 - 处理步骤: step_1756514148453_ny5fx9xny
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514148453_ny5fx9xny, 配置=step_1756514148453_ny5fx9xny
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:178 - 找到匹配的步骤配置: step_1756514148453_ny5fx9xny
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 20, 类型: response_time, 级别: warning
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: 步骤 step_1756514148453_ny5fx9xny 响应时间超时
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: 响应时间 9270.00ms 超过阈值 5000.00ms
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 1952 字符
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 92, 类型: response_time, 级别: warning
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:169 - 处理步骤: step_1756514258232_h4uuugdzo
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514258232_h4uuugdzo, 配置=step_1756514148453_ny5fx9xny
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514258232_h4uuugdzo, 配置=step_1756514258232_h4uuugdzo
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:178 - 找到匹配的步骤配置: step_1756514258232_h4uuugdzo
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 20, 类型: response_time, 级别: warning
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: 步骤 step_1756514258232_h4uuugdzo 响应时间超时
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: 响应时间 8170.00ms 超过阈值 5000.00ms
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 1952 字符
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 93, 类型: response_time, 级别: warning
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:87 - API步骤告警检查结果: 2 个告警
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 20
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'steps': [{'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'warning'}, 'assertions': [], 'name': '获取 ip', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'step_id': 'step_1756514148453_ny5fx9xny', 'variables': [{'expression': '$.ip', 'name': '$ip', 'source': 'body'}]}, {'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'severe'}, 'assertions': [], 'name': '获取名称', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '$ip'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '$ip'}]}, 'step_id': 'step_1756514258232_h4uuugdzo', 'variables': []}], 'variables': [], 'authentication': {'accessToken': '', 'headers': [], 'keyName': '', 'keyValue': '', 'location': 'header', 'password': '', 'token': '', 'tokenType': 'Bearer', 'type': 'none', 'username': ''}, 'statusAlertConfig': ['failed'], 'timeoutAlertEnabled': False, 'timeoutThreshold': 5000}
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: ['failed']
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:372 - 开始检查任务状态告警，配置: ['failed']
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:1332 - 检查任务状态告警 - 任务ID: 20
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:1336 - Agent上报的任务状态: success
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:1337 - 状态告警配置: ['failed']
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:1375 - 任务状态 'success' 不在告警配置 ['failed'] 中，不触发告警
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:380 - 未触发任务状态告警
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 2 个告警
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 1: 类型=response_time, 级别=warning, 标题=步骤 step_1756514148453_ny5fx9xny 响应时间超时
2025-08-31 09:27:43 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 2: 类型=response_time, 级别=warning, 标题=步骤 step_1756514258232_h4uuugdzo 响应时间超时
2025-08-31 09:27:43 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:27:43] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:27:46 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:27:46] "OPTIONS /api/v2/reports/overview?time_range=1h HTTP/1.1" 200 -
2025-08-31 09:27:46 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:27:46] "GET /api/v2/reports/overview?time_range=1h HTTP/1.1" 200 -
2025-08-31 09:28:43 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:28:43] "GET /api/v1/tasks/agent?enabled=true&agent_id=book HTTP/1.1" 200 -
2025-08-31 09:28:43 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 15, 任务名称: ceshi1baidu
2025-08-31 09:28:43 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 15, 'status': 'success', 'response_time': None, 'message': 'HTTP请求成功，状态码: 200', 'details': {'status': 'success', 'response_time': 96.6787338256836, 'message': 'HTTP请求成功，状态码: 200', 'webstatus': '正常', 'details': {'dns_time': 10.128021240234375, 'tcp_time': 14.799833297729492, 'ssl_time': 0, 'first_byte_time': 43.066978454589844, 'download_time': 28.596162796020508, 'http_time': 71.7477798461914, 'status_code': 200, 'response_headers': {'Bdpagetype': '1', 'Bdqid': '0x8c0022ba001b4ae0', 'Connection': 'keep-alive', 'Content-Encoding': 'gzip', 'Content-Type': 'text/html; charset=utf-8', 'Date': 'Sun, 31 Aug 2025 01:28:43 GMT', 'P3p': 'CP=" OTI DSP COR IVA OUR IND COM ", CP=" OTI DSP COR IVA OUR IND COM "', 'Server': 'BWS/1.1', 'Set-Cookie': 'BAIDUID=D1387AA261A225D30F7CB9D920B5EDDA:FG=1; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, BIDUPSID=D1387AA261A225D30F7CB9D920B5EDDA; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, PSTM=1756603723; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, BAIDUID=D1387AA261A225D3CF649C90413BAC35:FG=1; max-age=31536000; expires=Mon, 31-Aug-26 01:28:43 GMT; domain=.baidu.com; path=/; version=1; comment=bd, BDSVRTM=3; path=/, BD_HOME=1; path=/', 'Tr_id': 'super_0x8c0022ba001b4ae0', 'Traceid': '1756603723024642970610088101347570961120', 'X-Ua-Compatible': 'IE=Edge,chrome=1', 'X-Xss-Protection': '1;mode=block', 'Transfer-Encoding': 'chunked'}, 'content_length': 624165, 'dns_ips': ['183.240.99.169', '183.240.99.58'], 'final_url': 'http://www.baidu.com/'}}, 'created_at': '2025-08-31T09:28:43.826040', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:28:43 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {}
2025-08-31 09:28:43 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:28:43 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: http
2025-08-31 09:28:43 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:28:43 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:28:43 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:28:43 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 15
2025-08-31 09:28:43 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {}
2025-08-31 09:28:43 - app.services.alert_matcher - INFO - alert_matcher.py:364 - 任务配置为空，跳过任务配置告警检查
2025-08-31 09:28:43 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:28:43 - app.services.alert_matcher - INFO - alert_matcher.py:422 - 开始检查HTTP任务告警配置 - 任务ID: 15
2025-08-31 09:28:43 - app.services.alert_matcher - INFO - alert_matcher.py:426 - HTTP告警配置内容: {'enabled': False, 'rules': {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': False, 'level': 'warning'}}}
2025-08-31 09:28:43 - app.services.alert_matcher - INFO - alert_matcher.py:429 - HTTP告警配置未启用或为空，跳过检查
2025-08-31 09:28:43 - app.services.alert_matcher - INFO - alert_matcher.py:113 - HTTP告警配置检查结果: 0 个告警
2025-08-31 09:28:43 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 0 个告警
2025-08-31 09:28:43 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:28:43] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 17, 任务名称: 谷歌
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 17, 'status': 'failed', 'response_time': 14.024961948394775, 'message': '', 'details': {'status': 'failed', 'packet_sent': 4, 'packet_received': 0, 'packet_loss': 100.0, 'rtt_min': 0, 'rtt_avg': 0, 'rtt_max': 0, 'execution_time': 14.024961948394775, 'target': 'www.google.com'}, 'created_at': '2025-08-31T09:28:57.873476', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'count': 4}
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: ping
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 17
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'count': 4}
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: []
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:382 - 未配置任务状态告警
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:735 - 开始检查Ping任务告警配置 - 任务ID: 17
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:739 - Ping告警配置内容: {'enabled': False, 'rules': {'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'status': {'condition': '异常', 'enabled': False, 'level': 'warning'}}}
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:742 - Ping告警配置未启用或为空，跳过检查
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:122 - Ping告警配置检查结果: 0 个告警
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 0 个告警
2025-08-31 09:28:57 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:28:57] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 19, 任务名称: openapi
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 19, 'status': 'failed', 'response_time': 0.0005178451538085938, 'message': '连接失败，返回码: 61', 'details': {'status': 'failed', 'connected': False, 'target': 'localhost:8080', 'host': 'localhost', 'port': 8080, 'execution_time': 0.0005178451538085938, 'return_code': 61, 'message': '连接失败，返回码: 61'}, 'created_at': '2025-08-31T09:28:57.903376', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'timeout': 5}
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: tcp
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 19
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'timeout': 5}
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: []
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:382 - 未配置任务状态告警
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:974 - 开始检查TCP任务告警配置 - 任务ID: 19
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:978 - TCP告警配置内容: {'enabled': True, 'rules': {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}}
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:985 - TCP告警规则: {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:1025 - 检查TCP状态告警 - 任务ID: 19
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:1032 - 任务状态: failed, 告警条件: 异常
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:1042 - TCP状态告警触发: 状态=failed, 条件=异常
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 19, 类型: tcp_status, 级别: warning
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: TCP状态告警 - openapi
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: TCP任务状态为 failed，触发告警条件: 异常
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 449 字符
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 94, 类型: tcp_status, 级别: warning
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:131 - TCP告警配置检查结果: 1 个告警
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 1 个告警
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 1: 类型=tcp_status, 级别=warning, 标题=TCP状态告警 - openapi
2025-08-31 09:28:57 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:28:57] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:28:57 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:28:57] "[31m[1mGET /api/v1/system-variables HTTP/1.1[0m" 401 -
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 20, 任务名称: ceshiapi
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 20, 'status': 'success', 'response_time': None, 'message': '成功完成所有 2 个步骤', 'details': {'status': 'success', 'response_time': 31.04, 'message': '成功完成所有 2 个步骤', 'details': {'steps': [{'step_id': 'step_1756514148453_ny5fx9xny', 'name': '获取 ip', 'status': 'success', 'response_time': 16.27, 'message': '步骤执行成功', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'response': {'status_code': 200, 'headers': {'Server': 'Werkzeug/2.3.7 Python/3.13.2', 'Date': 'Sun, 31 Aug 2025 01:28:57 GMT', 'Content-Type': 'application/json', 'Content-Length': '28', 'Connection': 'close'}, 'content_type': 'application/json', 'body': {'ip': '192.168.31.17'}, 'size': 28}, 'assertions': [], 'extractions': [{'source': 'json_body', 'expression': '$.ip', 'variable_name': '$ip', 'success': True, 'message': '成功提取变量', 'value': '192.168.31.17'}]}, {'step_id': 'step_1756514258232_h4uuugdzo', 'name': '获取名称', 'status': 'success', 'response_time': 7.5, 'message': '步骤执行成功', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '192.168.31.17'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '192.168.31.17'}]}, 'response': {'status_code': 200, 'headers': {'Server': 'Werkzeug/2.3.7 Python/3.13.2', 'Date': 'Sun, 31 Aug 2025 01:28:57 GMT', 'Content-Type': 'application/json', 'Content-Length': '31', 'Connection': 'close'}, 'content_type': 'application/json', 'body': {'hostname': 'peterdembp'}, 'size': 31}, 'assertions': [], 'extractions': []}], 'variables': {}, 'total_assertions': 0, 'passed_assertions': 0, 'start_time': '2025-08-31T09:28:57.934035', 'end_time': '2025-08-31T09:28:57.965091'}}, 'created_at': '2025-08-31T09:28:57.965329', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'steps': [{'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'warning'}, 'assertions': [], 'name': '获取 ip', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'step_id': 'step_1756514148453_ny5fx9xny', 'variables': [{'expression': '$.ip', 'name': '$ip', 'source': 'body'}]}, {'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'severe'}, 'assertions': [], 'name': '获取名称', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '$ip'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '$ip'}]}, 'step_id': 'step_1756514258232_h4uuugdzo', 'variables': []}], 'variables': [], 'authentication': {'accessToken': '', 'headers': [], 'keyName': '', 'keyValue': '', 'location': 'header', 'password': '', 'token': '', 'tokenType': 'Bearer', 'type': 'none', 'username': ''}, 'statusAlertConfig': ['failed'], 'timeoutAlertEnabled': False, 'timeoutThreshold': 5000}
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:70 - 使用嵌套的details结构，找到 2 个步骤
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: api
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: True
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:77 - steps数量: 2
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:165 - 开始检查API步骤告警 - 步骤数量: 2, 配置步骤数量: 2
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:169 - 处理步骤: step_1756514148453_ny5fx9xny
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514148453_ny5fx9xny, 配置=step_1756514148453_ny5fx9xny
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:178 - 找到匹配的步骤配置: step_1756514148453_ny5fx9xny
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 20, 类型: response_time, 级别: warning
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: 步骤 step_1756514148453_ny5fx9xny 响应时间超时
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: 响应时间 16270.00ms 超过阈值 5000.00ms
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 1952 字符
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 95, 类型: response_time, 级别: warning
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:169 - 处理步骤: step_1756514258232_h4uuugdzo
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514258232_h4uuugdzo, 配置=step_1756514148453_ny5fx9xny
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514258232_h4uuugdzo, 配置=step_1756514258232_h4uuugdzo
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:178 - 找到匹配的步骤配置: step_1756514258232_h4uuugdzo
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 20, 类型: response_time, 级别: warning
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: 步骤 step_1756514258232_h4uuugdzo 响应时间超时
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: 响应时间 7500.00ms 超过阈值 5000.00ms
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 1952 字符
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 96, 类型: response_time, 级别: warning
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:87 - API步骤告警检查结果: 2 个告警
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 20
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'steps': [{'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'warning'}, 'assertions': [], 'name': '获取 ip', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'step_id': 'step_1756514148453_ny5fx9xny', 'variables': [{'expression': '$.ip', 'name': '$ip', 'source': 'body'}]}, {'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'severe'}, 'assertions': [], 'name': '获取名称', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '$ip'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '$ip'}]}, 'step_id': 'step_1756514258232_h4uuugdzo', 'variables': []}], 'variables': [], 'authentication': {'accessToken': '', 'headers': [], 'keyName': '', 'keyValue': '', 'location': 'header', 'password': '', 'token': '', 'tokenType': 'Bearer', 'type': 'none', 'username': ''}, 'statusAlertConfig': ['failed'], 'timeoutAlertEnabled': False, 'timeoutThreshold': 5000}
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: ['failed']
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:372 - 开始检查任务状态告警，配置: ['failed']
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:1332 - 检查任务状态告警 - 任务ID: 20
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:1336 - Agent上报的任务状态: success
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:1337 - 状态告警配置: ['failed']
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:1375 - 任务状态 'success' 不在告警配置 ['failed'] 中，不触发告警
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:380 - 未触发任务状态告警
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 2 个告警
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 1: 类型=response_time, 级别=warning, 标题=步骤 step_1756514148453_ny5fx9xny 响应时间超时
2025-08-31 09:28:57 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 2: 类型=response_time, 级别=warning, 标题=步骤 step_1756514258232_h4uuugdzo 响应时间超时
2025-08-31 09:28:57 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:28:57] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:29:34 - apscheduler.scheduler - DEBUG - base.py:954 - Looking for jobs to run
2025-08-31 09:29:34 - apscheduler.scheduler - DEBUG - base.py:1034 - Next wakeup is due at 2025-08-31 09:34:34.934184+08:00 (in 299.994644 seconds)
2025-08-31 09:29:34 - apscheduler.executors.default - INFO - base.py:123 - Running job "start_scheduler.<locals>.<lambda> (trigger: interval[0:05:00], next run at: 2025-08-31 09:34:34 CST)" (scheduled at 2025-08-31 09:29:34.934184+08:00)
2025-08-31 09:29:34 - apscheduler.executors.default - INFO - base.py:144 - Job "start_scheduler.<locals>.<lambda> (trigger: interval[0:05:00], next run at: 2025-08-31 09:34:34 CST)" executed successfully
2025-08-31 09:29:38 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:29:38] "OPTIONS /api/v2/tenants/e3900cb9-2840-46e0-bed9-44f592d051e7/usage HTTP/1.1" 200 -
2025-08-31 09:29:38 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:29:38] "OPTIONS /api/v2/tasks?page=1&per_page=10 HTTP/1.1" 200 -
2025-08-31 09:29:39 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:29:39] "GET /api/v2/tenants/e3900cb9-2840-46e0-bed9-44f592d051e7/usage HTTP/1.1" 200 -
2025-08-31 09:29:39 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:29:39] "GET /api/v2/tasks?page=1&per_page=10 HTTP/1.1" 200 -
2025-08-31 09:29:43 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:29:43] "OPTIONS /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:29:43 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:29:43] "GET /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:29:45 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:29:45] "OPTIONS /api/v2/reports/overview?time_range=1h HTTP/1.1" 200 -
2025-08-31 09:29:45 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:29:45] "GET /api/v2/reports/overview?time_range=1h HTTP/1.1" 200 -
2025-08-31 09:29:58 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:29:58] "GET /api/v1/tasks/agent?enabled=true&agent_id=book HTTP/1.1" 200 -
2025-08-31 09:29:58 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 15, 任务名称: ceshi1baidu
2025-08-31 09:29:58 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 15, 'status': 'success', 'response_time': None, 'message': 'HTTP请求成功，状态码: 200', 'details': {'status': 'success', 'response_time': 106.6429615020752, 'message': 'HTTP请求成功，状态码: 200', 'webstatus': '正常', 'details': {'dns_time': 6.947040557861328, 'tcp_time': 18.162965774536133, 'ssl_time': 0, 'first_byte_time': 41.83793067932129, 'download_time': 39.38484191894531, 'http_time': 81.52604103088379, 'status_code': 200, 'response_headers': {'Bdpagetype': '1', 'Bdqid': '0xaa4b18e500e61e37', 'Connection': 'keep-alive', 'Content-Encoding': 'gzip', 'Content-Type': 'text/html; charset=utf-8', 'Date': 'Sun, 31 Aug 2025 01:29:58 GMT', 'P3p': 'CP=" OTI DSP COR IVA OUR IND COM ", CP=" OTI DSP COR IVA OUR IND COM "', 'Server': 'BWS/1.1', 'Set-Cookie': 'BAIDUID=D6449F468EFD32B6760AE0E2AEC6509B:FG=1; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, BIDUPSID=D6449F468EFD32B6760AE0E2AEC6509B; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, PSTM=1756603798; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, BAIDUID=D6449F468EFD32B60FB8F612FF034EEE:FG=1; max-age=31536000; expires=Mon, 31-Aug-26 01:29:58 GMT; domain=.baidu.com; path=/; version=1; comment=bd, BDSVRTM=1; path=/, BD_HOME=1; path=/', 'Tr_id': 'super_0xaa4b18e500e61e37', 'Traceid': '1756603798375280231412270928981542706743', 'X-Ua-Compatible': 'IE=Edge,chrome=1', 'X-Xss-Protection': '1;mode=block', 'Transfer-Encoding': 'chunked'}, 'content_length': 624013, 'dns_ips': ['183.240.99.169', '183.240.99.58'], 'final_url': 'http://www.baidu.com/'}}, 'created_at': '2025-08-31T09:29:58.141722', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:29:58 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {}
2025-08-31 09:29:58 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:29:58 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: http
2025-08-31 09:29:58 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:29:58 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:29:58 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:29:58 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 15
2025-08-31 09:29:58 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {}
2025-08-31 09:29:58 - app.services.alert_matcher - INFO - alert_matcher.py:364 - 任务配置为空，跳过任务配置告警检查
2025-08-31 09:29:58 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:29:58 - app.services.alert_matcher - INFO - alert_matcher.py:422 - 开始检查HTTP任务告警配置 - 任务ID: 15
2025-08-31 09:29:58 - app.services.alert_matcher - INFO - alert_matcher.py:426 - HTTP告警配置内容: {'enabled': False, 'rules': {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': False, 'level': 'warning'}}}
2025-08-31 09:29:58 - app.services.alert_matcher - INFO - alert_matcher.py:429 - HTTP告警配置未启用或为空，跳过检查
2025-08-31 09:29:58 - app.services.alert_matcher - INFO - alert_matcher.py:113 - HTTP告警配置检查结果: 0 个告警
2025-08-31 09:29:58 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 0 个告警
2025-08-31 09:29:58 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:29:58] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 17, 任务名称: 谷歌
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 17, 'status': 'failed', 'response_time': 14.02568507194519, 'message': '', 'details': {'status': 'failed', 'packet_sent': 4, 'packet_received': 0, 'packet_loss': 100.0, 'rtt_min': 0, 'rtt_avg': 0, 'rtt_max': 0, 'execution_time': 14.02568507194519, 'target': 'www.google.com'}, 'created_at': '2025-08-31T09:30:12.199774', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'count': 4}
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: ping
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 17
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'count': 4}
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: []
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:382 - 未配置任务状态告警
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:735 - 开始检查Ping任务告警配置 - 任务ID: 17
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:739 - Ping告警配置内容: {'enabled': False, 'rules': {'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'status': {'condition': '异常', 'enabled': False, 'level': 'warning'}}}
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:742 - Ping告警配置未启用或为空，跳过检查
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:122 - Ping告警配置检查结果: 0 个告警
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 0 个告警
2025-08-31 09:30:12 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:30:12] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 19, 任务名称: openapi
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 19, 'status': 'failed', 'response_time': 0.0003230571746826172, 'message': '连接失败，返回码: 61', 'details': {'status': 'failed', 'connected': False, 'target': 'localhost:8080', 'host': 'localhost', 'port': 8080, 'execution_time': 0.0003230571746826172, 'return_code': 61, 'message': '连接失败，返回码: 61'}, 'created_at': '2025-08-31T09:30:12.228973', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'timeout': 5}
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: tcp
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 19
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'timeout': 5}
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: []
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:382 - 未配置任务状态告警
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:974 - 开始检查TCP任务告警配置 - 任务ID: 19
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:978 - TCP告警配置内容: {'enabled': True, 'rules': {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}}
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:985 - TCP告警规则: {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:1025 - 检查TCP状态告警 - 任务ID: 19
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:1032 - 任务状态: failed, 告警条件: 异常
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:1042 - TCP状态告警触发: 状态=failed, 条件=异常
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 19, 类型: tcp_status, 级别: warning
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: TCP状态告警 - openapi
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: TCP任务状态为 failed，触发告警条件: 异常
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 449 字符
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 97, 类型: tcp_status, 级别: warning
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:131 - TCP告警配置检查结果: 1 个告警
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 1 个告警
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 1: 类型=tcp_status, 级别=warning, 标题=TCP状态告警 - openapi
2025-08-31 09:30:12 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:30:12] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:30:12 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:30:12] "[31m[1mGET /api/v1/system-variables HTTP/1.1[0m" 401 -
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 20, 任务名称: ceshiapi
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 20, 'status': 'success', 'response_time': None, 'message': '成功完成所有 2 个步骤', 'details': {'status': 'success', 'response_time': 20.42, 'message': '成功完成所有 2 个步骤', 'details': {'steps': [{'step_id': 'step_1756514148453_ny5fx9xny', 'name': '获取 ip', 'status': 'success', 'response_time': 8.52, 'message': '步骤执行成功', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'response': {'status_code': 200, 'headers': {'Server': 'Werkzeug/2.3.7 Python/3.13.2', 'Date': 'Sun, 31 Aug 2025 01:30:12 GMT', 'Content-Type': 'application/json', 'Content-Length': '28', 'Connection': 'close'}, 'content_type': 'application/json', 'body': {'ip': '192.168.31.17'}, 'size': 28}, 'assertions': [], 'extractions': [{'source': 'json_body', 'expression': '$.ip', 'variable_name': '$ip', 'success': True, 'message': '成功提取变量', 'value': '192.168.31.17'}]}, {'step_id': 'step_1756514258232_h4uuugdzo', 'name': '获取名称', 'status': 'success', 'response_time': 7.13, 'message': '步骤执行成功', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '192.168.31.17'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '192.168.31.17'}]}, 'response': {'status_code': 200, 'headers': {'Server': 'Werkzeug/2.3.7 Python/3.13.2', 'Date': 'Sun, 31 Aug 2025 01:30:12 GMT', 'Content-Type': 'application/json', 'Content-Length': '31', 'Connection': 'close'}, 'content_type': 'application/json', 'body': {'hostname': 'peterdembp'}, 'size': 31}, 'assertions': [], 'extractions': []}], 'variables': {}, 'total_assertions': 0, 'passed_assertions': 0, 'start_time': '2025-08-31T09:30:12.248029', 'end_time': '2025-08-31T09:30:12.268453'}}, 'created_at': '2025-08-31T09:30:12.268663', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'steps': [{'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'warning'}, 'assertions': [], 'name': '获取 ip', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'step_id': 'step_1756514148453_ny5fx9xny', 'variables': [{'expression': '$.ip', 'name': '$ip', 'source': 'body'}]}, {'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'severe'}, 'assertions': [], 'name': '获取名称', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '$ip'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '$ip'}]}, 'step_id': 'step_1756514258232_h4uuugdzo', 'variables': []}], 'variables': [], 'authentication': {'accessToken': '', 'headers': [], 'keyName': '', 'keyValue': '', 'location': 'header', 'password': '', 'token': '', 'tokenType': 'Bearer', 'type': 'none', 'username': ''}, 'statusAlertConfig': ['failed'], 'timeoutAlertEnabled': False, 'timeoutThreshold': 5000}
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:70 - 使用嵌套的details结构，找到 2 个步骤
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: api
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: True
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:77 - steps数量: 2
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:165 - 开始检查API步骤告警 - 步骤数量: 2, 配置步骤数量: 2
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:169 - 处理步骤: step_1756514148453_ny5fx9xny
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514148453_ny5fx9xny, 配置=step_1756514148453_ny5fx9xny
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:178 - 找到匹配的步骤配置: step_1756514148453_ny5fx9xny
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 20, 类型: response_time, 级别: warning
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: 步骤 step_1756514148453_ny5fx9xny 响应时间超时
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: 响应时间 8520.00ms 超过阈值 5000.00ms
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 1952 字符
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 98, 类型: response_time, 级别: warning
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:169 - 处理步骤: step_1756514258232_h4uuugdzo
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514258232_h4uuugdzo, 配置=step_1756514148453_ny5fx9xny
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514258232_h4uuugdzo, 配置=step_1756514258232_h4uuugdzo
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:178 - 找到匹配的步骤配置: step_1756514258232_h4uuugdzo
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 20, 类型: response_time, 级别: warning
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: 步骤 step_1756514258232_h4uuugdzo 响应时间超时
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: 响应时间 7130.00ms 超过阈值 5000.00ms
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 1952 字符
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 99, 类型: response_time, 级别: warning
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:87 - API步骤告警检查结果: 2 个告警
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 20
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'steps': [{'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'warning'}, 'assertions': [], 'name': '获取 ip', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'step_id': 'step_1756514148453_ny5fx9xny', 'variables': [{'expression': '$.ip', 'name': '$ip', 'source': 'body'}]}, {'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'severe'}, 'assertions': [], 'name': '获取名称', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '$ip'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '$ip'}]}, 'step_id': 'step_1756514258232_h4uuugdzo', 'variables': []}], 'variables': [], 'authentication': {'accessToken': '', 'headers': [], 'keyName': '', 'keyValue': '', 'location': 'header', 'password': '', 'token': '', 'tokenType': 'Bearer', 'type': 'none', 'username': ''}, 'statusAlertConfig': ['failed'], 'timeoutAlertEnabled': False, 'timeoutThreshold': 5000}
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: ['failed']
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:372 - 开始检查任务状态告警，配置: ['failed']
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:1332 - 检查任务状态告警 - 任务ID: 20
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:1336 - Agent上报的任务状态: success
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:1337 - 状态告警配置: ['failed']
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:1375 - 任务状态 'success' 不在告警配置 ['failed'] 中，不触发告警
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:380 - 未触发任务状态告警
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 2 个告警
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 1: 类型=response_time, 级别=warning, 标题=步骤 step_1756514148453_ny5fx9xny 响应时间超时
2025-08-31 09:30:12 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 2: 类型=response_time, 级别=warning, 标题=步骤 step_1756514258232_h4uuugdzo 响应时间超时
2025-08-31 09:30:12 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:30:12] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:31:01 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:01] "[33mOPTIONS /v1/auth/login HTTP/1.1[0m" 404 -
2025-08-31 09:31:02 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:02] "[33mOPTIONS /v1/auth/login HTTP/1.1[0m" 404 -
2025-08-31 09:31:12 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:12] "GET /api/v1/tasks/agent?enabled=true&agent_id=book HTTP/1.1" 200 -
2025-08-31 09:31:12 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 15, 任务名称: ceshi1baidu
2025-08-31 09:31:12 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 15, 'status': 'success', 'response_time': None, 'message': 'HTTP请求成功，状态码: 200', 'details': {'status': 'success', 'response_time': 92.09394454956055, 'message': 'HTTP请求成功，状态码: 200', 'webstatus': '正常', 'details': {'dns_time': 7.398128509521484, 'tcp_time': 20.88189125061035, 'ssl_time': 0, 'first_byte_time': 39.14499282836914, 'download_time': 24.55282211303711, 'http_time': 63.80724906921387, 'status_code': 200, 'response_headers': {'Bdpagetype': '1', 'Bdqid': '0xe5c6cdba00e52690', 'Connection': 'keep-alive', 'Content-Encoding': 'gzip', 'Content-Type': 'text/html; charset=utf-8', 'Date': 'Sun, 31 Aug 2025 01:31:12 GMT', 'P3p': 'CP=" OTI DSP COR IVA OUR IND COM ", CP=" OTI DSP COR IVA OUR IND COM "', 'Server': 'BWS/1.1', 'Set-Cookie': 'BAIDUID=4AA43DE7BDFEAA65FA6385BC2DF9A97D:FG=1; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, BIDUPSID=4AA43DE7BDFEAA65FA6385BC2DF9A97D; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, PSTM=1756603872; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, BAIDUID=4AA43DE7BDFEAA65F1C8C58BA6BDB2F8:FG=1; max-age=31536000; expires=Mon, 31-Aug-26 01:31:12 GMT; domain=.baidu.com; path=/; version=1; comment=bd, BDSVRTM=4; path=/, BD_HOME=1; path=/', 'Tr_id': 'super_0xe5c6cdba00e52690', 'Traceid': '1756603872400446055416557147278836835984', 'X-Ua-Compatible': 'IE=Edge,chrome=1', 'X-Xss-Protection': '1;mode=block', 'Transfer-Encoding': 'chunked'}, 'content_length': 624131, 'dns_ips': ['183.240.99.58', '183.240.99.169'], 'final_url': 'http://www.baidu.com/'}}, 'created_at': '2025-08-31T09:31:12.439737', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:31:12 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {}
2025-08-31 09:31:12 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:31:12 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: http
2025-08-31 09:31:12 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:31:12 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:31:12 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:31:12 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 15
2025-08-31 09:31:12 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {}
2025-08-31 09:31:12 - app.services.alert_matcher - INFO - alert_matcher.py:364 - 任务配置为空，跳过任务配置告警检查
2025-08-31 09:31:12 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:31:12 - app.services.alert_matcher - INFO - alert_matcher.py:422 - 开始检查HTTP任务告警配置 - 任务ID: 15
2025-08-31 09:31:12 - app.services.alert_matcher - INFO - alert_matcher.py:426 - HTTP告警配置内容: {'enabled': False, 'rules': {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': False, 'level': 'warning'}}}
2025-08-31 09:31:12 - app.services.alert_matcher - INFO - alert_matcher.py:429 - HTTP告警配置未启用或为空，跳过检查
2025-08-31 09:31:12 - app.services.alert_matcher - INFO - alert_matcher.py:113 - HTTP告警配置检查结果: 0 个告警
2025-08-31 09:31:12 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 0 个告警
2025-08-31 09:31:12 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:12] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:31:15 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:15] "POST /api/v1/nodes/heartbeat HTTP/1.1" 200 -
2025-08-31 09:31:24 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:24] "OPTIONS /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:31:26 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:26] "GET /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 17, 任务名称: 谷歌
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 17, 'status': 'failed', 'response_time': 14.016802072525024, 'message': '', 'details': {'status': 'failed', 'packet_sent': 4, 'packet_received': 0, 'packet_loss': 100.0, 'rtt_min': 0, 'rtt_avg': 0, 'rtt_max': 0, 'execution_time': 14.016802072525024, 'target': 'www.google.com'}, 'created_at': '2025-08-31T09:31:26.479013', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'count': 4}
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: ping
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 17
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'count': 4}
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: []
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:382 - 未配置任务状态告警
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:735 - 开始检查Ping任务告警配置 - 任务ID: 17
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:739 - Ping告警配置内容: {'enabled': False, 'rules': {'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'status': {'condition': '异常', 'enabled': False, 'level': 'warning'}}}
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:742 - Ping告警配置未启用或为空，跳过检查
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:122 - Ping告警配置检查结果: 0 个告警
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 0 个告警
2025-08-31 09:31:26 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:26] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 19, 任务名称: openapi
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 19, 'status': 'failed', 'response_time': 0.0004899501800537109, 'message': '连接失败，返回码: 61', 'details': {'status': 'failed', 'connected': False, 'target': 'localhost:8080', 'host': 'localhost', 'port': 8080, 'execution_time': 0.0004899501800537109, 'return_code': 61, 'message': '连接失败，返回码: 61'}, 'created_at': '2025-08-31T09:31:26.525770', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'timeout': 5}
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: tcp
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 19
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'timeout': 5}
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: []
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:382 - 未配置任务状态告警
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:974 - 开始检查TCP任务告警配置 - 任务ID: 19
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:978 - TCP告警配置内容: {'enabled': True, 'rules': {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}}
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:985 - TCP告警规则: {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:1025 - 检查TCP状态告警 - 任务ID: 19
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:1032 - 任务状态: failed, 告警条件: 异常
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:1042 - TCP状态告警触发: 状态=failed, 条件=异常
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 19, 类型: tcp_status, 级别: warning
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: TCP状态告警 - openapi
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: TCP任务状态为 failed，触发告警条件: 异常
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 449 字符
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 100, 类型: tcp_status, 级别: warning
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:131 - TCP告警配置检查结果: 1 个告警
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 1 个告警
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 1: 类型=tcp_status, 级别=warning, 标题=TCP状态告警 - openapi
2025-08-31 09:31:26 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:26] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:31:26 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:26] "[31m[1mGET /api/v1/system-variables HTTP/1.1[0m" 401 -
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 20, 任务名称: ceshiapi
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 20, 'status': 'success', 'response_time': None, 'message': '成功完成所有 2 个步骤', 'details': {'status': 'success', 'response_time': 60.42, 'message': '成功完成所有 2 个步骤', 'details': {'steps': [{'step_id': 'step_1756514148453_ny5fx9xny', 'name': '获取 ip', 'status': 'success', 'response_time': 29.24, 'message': '步骤执行成功', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'response': {'status_code': 200, 'headers': {'Server': 'Werkzeug/2.3.7 Python/3.13.2', 'Date': 'Sun, 31 Aug 2025 01:31:26 GMT', 'Content-Type': 'application/json', 'Content-Length': '28', 'Connection': 'close'}, 'content_type': 'application/json', 'body': {'ip': '192.168.31.17'}, 'size': 28}, 'assertions': [], 'extractions': [{'source': 'json_body', 'expression': '$.ip', 'variable_name': '$ip', 'success': True, 'message': '成功提取变量', 'value': '192.168.31.17'}]}, {'step_id': 'step_1756514258232_h4uuugdzo', 'name': '获取名称', 'status': 'success', 'response_time': 13.14, 'message': '步骤执行成功', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '192.168.31.17'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '192.168.31.17'}]}, 'response': {'status_code': 200, 'headers': {'Server': 'Werkzeug/2.3.7 Python/3.13.2', 'Date': 'Sun, 31 Aug 2025 01:31:26 GMT', 'Content-Type': 'application/json', 'Content-Length': '31', 'Connection': 'close'}, 'content_type': 'application/json', 'body': {'hostname': 'peterdembp'}, 'size': 31}, 'assertions': [], 'extractions': []}], 'variables': {}, 'total_assertions': 0, 'passed_assertions': 0, 'start_time': '2025-08-31T09:31:26.698465', 'end_time': '2025-08-31T09:31:26.758909'}}, 'created_at': '2025-08-31T09:31:26.769664', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'steps': [{'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'warning'}, 'assertions': [], 'name': '获取 ip', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'step_id': 'step_1756514148453_ny5fx9xny', 'variables': [{'expression': '$.ip', 'name': '$ip', 'source': 'body'}]}, {'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'severe'}, 'assertions': [], 'name': '获取名称', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '$ip'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '$ip'}]}, 'step_id': 'step_1756514258232_h4uuugdzo', 'variables': []}], 'variables': [], 'authentication': {'accessToken': '', 'headers': [], 'keyName': '', 'keyValue': '', 'location': 'header', 'password': '', 'token': '', 'tokenType': 'Bearer', 'type': 'none', 'username': ''}, 'statusAlertConfig': ['failed'], 'timeoutAlertEnabled': False, 'timeoutThreshold': 5000}
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:70 - 使用嵌套的details结构，找到 2 个步骤
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: api
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: True
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:77 - steps数量: 2
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:165 - 开始检查API步骤告警 - 步骤数量: 2, 配置步骤数量: 2
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:169 - 处理步骤: step_1756514148453_ny5fx9xny
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514148453_ny5fx9xny, 配置=step_1756514148453_ny5fx9xny
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:178 - 找到匹配的步骤配置: step_1756514148453_ny5fx9xny
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 20, 类型: response_time, 级别: warning
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: 步骤 step_1756514148453_ny5fx9xny 响应时间超时
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: 响应时间 29240.00ms 超过阈值 5000.00ms
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 1954 字符
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 101, 类型: response_time, 级别: warning
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:169 - 处理步骤: step_1756514258232_h4uuugdzo
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514258232_h4uuugdzo, 配置=step_1756514148453_ny5fx9xny
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514258232_h4uuugdzo, 配置=step_1756514258232_h4uuugdzo
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:178 - 找到匹配的步骤配置: step_1756514258232_h4uuugdzo
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 20, 类型: response_time, 级别: warning
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: 步骤 step_1756514258232_h4uuugdzo 响应时间超时
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: 响应时间 13140.00ms 超过阈值 5000.00ms
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 1954 字符
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 102, 类型: response_time, 级别: warning
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:87 - API步骤告警检查结果: 2 个告警
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 20
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'steps': [{'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'warning'}, 'assertions': [], 'name': '获取 ip', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'step_id': 'step_1756514148453_ny5fx9xny', 'variables': [{'expression': '$.ip', 'name': '$ip', 'source': 'body'}]}, {'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'severe'}, 'assertions': [], 'name': '获取名称', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '$ip'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '$ip'}]}, 'step_id': 'step_1756514258232_h4uuugdzo', 'variables': []}], 'variables': [], 'authentication': {'accessToken': '', 'headers': [], 'keyName': '', 'keyValue': '', 'location': 'header', 'password': '', 'token': '', 'tokenType': 'Bearer', 'type': 'none', 'username': ''}, 'statusAlertConfig': ['failed'], 'timeoutAlertEnabled': False, 'timeoutThreshold': 5000}
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: ['failed']
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:372 - 开始检查任务状态告警，配置: ['failed']
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:1332 - 检查任务状态告警 - 任务ID: 20
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:1336 - Agent上报的任务状态: success
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:1337 - 状态告警配置: ['failed']
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:1375 - 任务状态 'success' 不在告警配置 ['failed'] 中，不触发告警
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:380 - 未触发任务状态告警
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 2 个告警
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 1: 类型=response_time, 级别=warning, 标题=步骤 step_1756514148453_ny5fx9xny 响应时间超时
2025-08-31 09:31:26 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 2: 类型=response_time, 级别=warning, 标题=步骤 step_1756514258232_h4uuugdzo 响应时间超时
2025-08-31 09:31:26 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:26] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:31:28 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:28] "GET /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:31:29 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:29] "GET /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:31:30 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:30] "OPTIONS /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:31:30 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:30] "GET /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:31:31 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:31] "GET /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:31:32 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:32] "GET /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:31:35 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:35] "[33mOPTIONS /v1/auth/login HTTP/1.1[0m" 404 -
2025-08-31 09:31:35 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:35] "GET /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:31:35 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:35] "[33mOPTIONS /v1/auth/login HTTP/1.1[0m" 404 -
2025-08-31 09:31:39 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:39] "[33mOPTIONS /v1/auth/login HTTP/1.1[0m" 404 -
2025-08-31 09:31:40 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:40] "OPTIONS /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:31:40 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:40] "GET /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:31:50 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:50] "OPTIONS /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:31:50 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:50] "GET /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:31:51 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:51] "[33mOPTIONS /v1/auth/login HTTP/1.1[0m" 404 -
2025-08-31 09:31:51 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:51] "[33mOPTIONS /v1/auth/login HTTP/1.1[0m" 404 -
2025-08-31 09:31:59 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:59] "OPTIONS /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:31:59 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:31:59] "GET /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:32:02 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:32:02] "[33mOPTIONS /v1/auth/login HTTP/1.1[0m" 404 -
2025-08-31 09:32:03 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:32:03] "[33mOPTIONS /v1/auth/login HTTP/1.1[0m" 404 -
2025-08-31 09:32:12 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:32:12] "OPTIONS /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:32:13 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:32:13] "GET /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:32:16 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:32:16] "OPTIONS /api/v2/tenants/e3900cb9-2840-46e0-bed9-44f592d051e7/usage HTTP/1.1" 200 -
2025-08-31 09:32:16 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:32:16] "OPTIONS /api/v2/tasks?page=1&per_page=10 HTTP/1.1" 200 -
2025-08-31 09:32:16 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:32:16] "GET /api/v2/tenants/e3900cb9-2840-46e0-bed9-44f592d051e7/usage HTTP/1.1" 200 -
2025-08-31 09:32:16 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:32:16] "GET /api/v2/tasks?page=1&per_page=10 HTTP/1.1" 200 -
2025-08-31 09:32:17 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:32:17] "[33mOPTIONS /v1/auth/login HTTP/1.1[0m" 404 -
2025-08-31 09:32:19 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:32:19] "[33mOPTIONS /v1/auth/login HTTP/1.1[0m" 404 -
2025-08-31 09:32:22 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:32:22] "OPTIONS /api/v2/tenants/e3900cb9-2840-46e0-bed9-44f592d051e7/usage HTTP/1.1" 200 -
2025-08-31 09:32:22 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:32:22] "OPTIONS /api/v2/tasks?page=1&per_page=10 HTTP/1.1" 200 -
2025-08-31 09:32:22 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:32:22] "GET /api/v2/tenants/e3900cb9-2840-46e0-bed9-44f592d051e7/usage HTTP/1.1" 200 -
2025-08-31 09:32:22 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:32:22] "GET /api/v2/tasks?page=1&per_page=10 HTTP/1.1" 200 -
2025-08-31 09:32:25 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:32:25] "OPTIONS /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:32:25 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:32:25] "GET /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:32:26 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:32:26] "GET /api/v1/tasks/agent?enabled=true&agent_id=book HTTP/1.1" 200 -
2025-08-31 09:32:27 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 15, 任务名称: ceshi1baidu
2025-08-31 09:32:27 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 15, 'status': 'success', 'response_time': None, 'message': 'HTTP请求成功，状态码: 200', 'details': {'status': 'success', 'response_time': 171.28705978393555, 'message': 'HTTP请求成功，状态码: 200', 'webstatus': '正常', 'details': {'dns_time': 6.289958953857422, 'tcp_time': 16.559123992919922, 'ssl_time': 0, 'first_byte_time': 40.26007652282715, 'download_time': 108.09588432312012, 'http_time': 148.43416213989258, 'status_code': 200, 'response_headers': {'Bdpagetype': '1', 'Bdqid': '0xa26f748300dfbda8', 'Connection': 'keep-alive', 'Content-Encoding': 'gzip', 'Content-Type': 'text/html; charset=utf-8', 'Date': 'Sun, 31 Aug 2025 01:32:27 GMT', 'P3p': 'CP=" OTI DSP COR IVA OUR IND COM ", CP=" OTI DSP COR IVA OUR IND COM "', 'Server': 'BWS/1.1', 'Set-Cookie': 'BAIDUID=97B4E6171F8C36CB28C88D6CA4837D7D:FG=1; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, BIDUPSID=97B4E6171F8C36CB28C88D6CA4837D7D; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, PSTM=1756603947; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, BAIDUID=97B4E6171F8C36CBF8A5863F7FD4AEF7:FG=1; max-age=31536000; expires=Mon, 31-Aug-26 01:32:27 GMT; domain=.baidu.com; path=/; version=1; comment=bd, BDSVRTM=2; path=/, BD_HOME=1; path=/', 'Tr_id': 'super_0xa26f748300dfbda8', 'Traceid': '1756603947019609805811704702062563409320', 'X-Ua-Compatible': 'IE=Edge,chrome=1', 'X-Xss-Protection': '1;mode=block', 'Transfer-Encoding': 'chunked'}, 'content_length': 623914, 'dns_ips': ['183.240.99.58', '183.240.99.169'], 'final_url': 'http://www.baidu.com/'}}, 'created_at': '2025-08-31T09:32:27.159550', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:32:27 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {}
2025-08-31 09:32:27 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:32:27 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: http
2025-08-31 09:32:27 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:32:27 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:32:27 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:32:27 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 15
2025-08-31 09:32:27 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {}
2025-08-31 09:32:27 - app.services.alert_matcher - INFO - alert_matcher.py:364 - 任务配置为空，跳过任务配置告警检查
2025-08-31 09:32:27 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:32:27 - app.services.alert_matcher - INFO - alert_matcher.py:422 - 开始检查HTTP任务告警配置 - 任务ID: 15
2025-08-31 09:32:27 - app.services.alert_matcher - INFO - alert_matcher.py:426 - HTTP告警配置内容: {'enabled': False, 'rules': {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': False, 'level': 'warning'}}}
2025-08-31 09:32:27 - app.services.alert_matcher - INFO - alert_matcher.py:429 - HTTP告警配置未启用或为空，跳过检查
2025-08-31 09:32:27 - app.services.alert_matcher - INFO - alert_matcher.py:113 - HTTP告警配置检查结果: 0 个告警
2025-08-31 09:32:27 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 0 个告警
2025-08-31 09:32:27 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:32:27] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 17, 任务名称: 谷歌
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 17, 'status': 'failed', 'response_time': 14.022505044937134, 'message': '', 'details': {'status': 'failed', 'packet_sent': 4, 'packet_received': 0, 'packet_loss': 100.0, 'rtt_min': 0, 'rtt_avg': 0, 'rtt_max': 0, 'execution_time': 14.022505044937134, 'target': 'www.google.com'}, 'created_at': '2025-08-31T09:32:41.209279', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'count': 4}
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: ping
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 17
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'count': 4}
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: []
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:382 - 未配置任务状态告警
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:735 - 开始检查Ping任务告警配置 - 任务ID: 17
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:739 - Ping告警配置内容: {'enabled': False, 'rules': {'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'status': {'condition': '异常', 'enabled': False, 'level': 'warning'}}}
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:742 - Ping告警配置未启用或为空，跳过检查
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:122 - Ping告警配置检查结果: 0 个告警
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 0 个告警
2025-08-31 09:32:41 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:32:41] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 19, 任务名称: openapi
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 19, 'status': 'failed', 'response_time': 0.00047898292541503906, 'message': '连接失败，返回码: 61', 'details': {'status': 'failed', 'connected': False, 'target': 'localhost:8080', 'host': 'localhost', 'port': 8080, 'execution_time': 0.00047898292541503906, 'return_code': 61, 'message': '连接失败，返回码: 61'}, 'created_at': '2025-08-31T09:32:41.240017', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'timeout': 5}
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: tcp
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 19
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'timeout': 5}
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: []
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:382 - 未配置任务状态告警
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:974 - 开始检查TCP任务告警配置 - 任务ID: 19
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:978 - TCP告警配置内容: {'enabled': True, 'rules': {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}}
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:985 - TCP告警规则: {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:1025 - 检查TCP状态告警 - 任务ID: 19
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:1032 - 任务状态: failed, 告警条件: 异常
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:1042 - TCP状态告警触发: 状态=failed, 条件=异常
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 19, 类型: tcp_status, 级别: warning
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: TCP状态告警 - openapi
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: TCP任务状态为 failed，触发告警条件: 异常
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 451 字符
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 103, 类型: tcp_status, 级别: warning
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:131 - TCP告警配置检查结果: 1 个告警
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 1 个告警
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 1: 类型=tcp_status, 级别=warning, 标题=TCP状态告警 - openapi
2025-08-31 09:32:41 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:32:41] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:32:41 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:32:41] "[31m[1mGET /api/v1/system-variables HTTP/1.1[0m" 401 -
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 20, 任务名称: ceshiapi
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 20, 'status': 'success', 'response_time': None, 'message': '成功完成所有 2 个步骤', 'details': {'status': 'success', 'response_time': 25.65, 'message': '成功完成所有 2 个步骤', 'details': {'steps': [{'step_id': 'step_1756514148453_ny5fx9xny', 'name': '获取 ip', 'status': 'success', 'response_time': 9.8, 'message': '步骤执行成功', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'response': {'status_code': 200, 'headers': {'Server': 'Werkzeug/2.3.7 Python/3.13.2', 'Date': 'Sun, 31 Aug 2025 01:32:41 GMT', 'Content-Type': 'application/json', 'Content-Length': '28', 'Connection': 'close'}, 'content_type': 'application/json', 'body': {'ip': '192.168.31.17'}, 'size': 28}, 'assertions': [], 'extractions': [{'source': 'json_body', 'expression': '$.ip', 'variable_name': '$ip', 'success': True, 'message': '成功提取变量', 'value': '192.168.31.17'}]}, {'step_id': 'step_1756514258232_h4uuugdzo', 'name': '获取名称', 'status': 'success', 'response_time': 8.47, 'message': '步骤执行成功', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '192.168.31.17'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '192.168.31.17'}]}, 'response': {'status_code': 200, 'headers': {'Server': 'Werkzeug/2.3.7 Python/3.13.2', 'Date': 'Sun, 31 Aug 2025 01:32:41 GMT', 'Content-Type': 'application/json', 'Content-Length': '31', 'Connection': 'close'}, 'content_type': 'application/json', 'body': {'hostname': 'peterdembp'}, 'size': 31}, 'assertions': [], 'extractions': []}], 'variables': {}, 'total_assertions': 0, 'passed_assertions': 0, 'start_time': '2025-08-31T09:32:41.268496', 'end_time': '2025-08-31T09:32:41.294152'}}, 'created_at': '2025-08-31T09:32:41.294421', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'steps': [{'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'warning'}, 'assertions': [], 'name': '获取 ip', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'step_id': 'step_1756514148453_ny5fx9xny', 'variables': [{'expression': '$.ip', 'name': '$ip', 'source': 'body'}]}, {'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'severe'}, 'assertions': [], 'name': '获取名称', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '$ip'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '$ip'}]}, 'step_id': 'step_1756514258232_h4uuugdzo', 'variables': []}], 'variables': [], 'authentication': {'accessToken': '', 'headers': [], 'keyName': '', 'keyValue': '', 'location': 'header', 'password': '', 'token': '', 'tokenType': 'Bearer', 'type': 'none', 'username': ''}, 'statusAlertConfig': ['failed'], 'timeoutAlertEnabled': False, 'timeoutThreshold': 5000}
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:70 - 使用嵌套的details结构，找到 2 个步骤
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: api
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: True
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:77 - steps数量: 2
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:165 - 开始检查API步骤告警 - 步骤数量: 2, 配置步骤数量: 2
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:169 - 处理步骤: step_1756514148453_ny5fx9xny
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514148453_ny5fx9xny, 配置=step_1756514148453_ny5fx9xny
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:178 - 找到匹配的步骤配置: step_1756514148453_ny5fx9xny
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 20, 类型: response_time, 级别: warning
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: 步骤 step_1756514148453_ny5fx9xny 响应时间超时
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: 响应时间 9800.00ms 超过阈值 5000.00ms
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 1951 字符
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 104, 类型: response_time, 级别: warning
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:169 - 处理步骤: step_1756514258232_h4uuugdzo
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514258232_h4uuugdzo, 配置=step_1756514148453_ny5fx9xny
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514258232_h4uuugdzo, 配置=step_1756514258232_h4uuugdzo
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:178 - 找到匹配的步骤配置: step_1756514258232_h4uuugdzo
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 20, 类型: response_time, 级别: warning
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: 步骤 step_1756514258232_h4uuugdzo 响应时间超时
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: 响应时间 8470.00ms 超过阈值 5000.00ms
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 1951 字符
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 105, 类型: response_time, 级别: warning
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:87 - API步骤告警检查结果: 2 个告警
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 20
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'steps': [{'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'warning'}, 'assertions': [], 'name': '获取 ip', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'step_id': 'step_1756514148453_ny5fx9xny', 'variables': [{'expression': '$.ip', 'name': '$ip', 'source': 'body'}]}, {'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'severe'}, 'assertions': [], 'name': '获取名称', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '$ip'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '$ip'}]}, 'step_id': 'step_1756514258232_h4uuugdzo', 'variables': []}], 'variables': [], 'authentication': {'accessToken': '', 'headers': [], 'keyName': '', 'keyValue': '', 'location': 'header', 'password': '', 'token': '', 'tokenType': 'Bearer', 'type': 'none', 'username': ''}, 'statusAlertConfig': ['failed'], 'timeoutAlertEnabled': False, 'timeoutThreshold': 5000}
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: ['failed']
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:372 - 开始检查任务状态告警，配置: ['failed']
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:1332 - 检查任务状态告警 - 任务ID: 20
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:1336 - Agent上报的任务状态: success
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:1337 - 状态告警配置: ['failed']
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:1375 - 任务状态 'success' 不在告警配置 ['failed'] 中，不触发告警
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:380 - 未触发任务状态告警
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 2 个告警
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 1: 类型=response_time, 级别=warning, 标题=步骤 step_1756514148453_ny5fx9xny 响应时间超时
2025-08-31 09:32:41 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 2: 类型=response_time, 级别=warning, 标题=步骤 step_1756514258232_h4uuugdzo 响应时间超时
2025-08-31 09:32:41 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:32:41] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:32:47 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:32:47] "OPTIONS /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:32:48 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:32:48] "GET /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:33:41 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:33:41] "GET /api/v1/tasks/agent?enabled=true&agent_id=book HTTP/1.1" 200 -
2025-08-31 09:33:41 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 15, 任务名称: ceshi1baidu
2025-08-31 09:33:41 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 15, 'status': 'success', 'response_time': None, 'message': 'HTTP请求成功，状态码: 200', 'details': {'status': 'success', 'response_time': 110.49509048461914, 'message': 'HTTP请求成功，状态码: 200', 'webstatus': '正常', 'details': {'dns_time': 30.259370803833008, 'tcp_time': 13.389110565185547, 'ssl_time': 0, 'first_byte_time': 38.24567794799805, 'download_time': 28.488874435424805, 'http_time': 66.84327125549316, 'status_code': 200, 'response_headers': {'Bdpagetype': '1', 'Bdqid': '0xc722668500e34a63', 'Connection': 'keep-alive', 'Content-Encoding': 'gzip', 'Content-Type': 'text/html; charset=utf-8', 'Date': 'Sun, 31 Aug 2025 01:33:41 GMT', 'P3p': 'CP=" OTI DSP COR IVA OUR IND COM ", CP=" OTI DSP COR IVA OUR IND COM "', 'Server': 'BWS/1.1', 'Set-Cookie': 'BAIDUID=07090AF9E22CF51F31DE04E2B1232A71:FG=1; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, BIDUPSID=07090AF9E22CF51F31DE04E2B1232A71; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, PSTM=1756604021; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, BAIDUID=07090AF9E22CF51F07ECD464B0396594:FG=1; max-age=31536000; expires=Mon, 31-Aug-26 01:33:41 GMT; domain=.baidu.com; path=/; version=1; comment=bd, BDSVRTM=2; path=/, BD_HOME=1; path=/', 'Tr_id': 'super_0xc722668500e34a63', 'Traceid': '1756604021373602509814349144084187400803', 'X-Ua-Compatible': 'IE=Edge,chrome=1', 'X-Xss-Protection': '1;mode=block', 'Transfer-Encoding': 'chunked'}, 'content_length': 623923, 'dns_ips': ['183.240.99.169', '183.240.99.58'], 'final_url': 'http://www.baidu.com/'}}, 'created_at': '2025-08-31T09:33:41.477138', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:33:41 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {}
2025-08-31 09:33:41 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:33:41 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: http
2025-08-31 09:33:41 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:33:41 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:33:41 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:33:41 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 15
2025-08-31 09:33:41 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {}
2025-08-31 09:33:41 - app.services.alert_matcher - INFO - alert_matcher.py:364 - 任务配置为空，跳过任务配置告警检查
2025-08-31 09:33:41 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:33:41 - app.services.alert_matcher - INFO - alert_matcher.py:422 - 开始检查HTTP任务告警配置 - 任务ID: 15
2025-08-31 09:33:41 - app.services.alert_matcher - INFO - alert_matcher.py:426 - HTTP告警配置内容: {'enabled': False, 'rules': {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': False, 'level': 'warning'}}}
2025-08-31 09:33:41 - app.services.alert_matcher - INFO - alert_matcher.py:429 - HTTP告警配置未启用或为空，跳过检查
2025-08-31 09:33:41 - app.services.alert_matcher - INFO - alert_matcher.py:113 - HTTP告警配置检查结果: 0 个告警
2025-08-31 09:33:41 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 0 个告警
2025-08-31 09:33:41 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:33:41] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:33:51 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:33:51] "OPTIONS /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:33:51 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:33:51] "GET /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 17, 任务名称: 谷歌
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 17, 'status': 'failed', 'response_time': 14.031527757644653, 'message': '', 'details': {'status': 'failed', 'packet_sent': 4, 'packet_received': 0, 'packet_loss': 100.0, 'rtt_min': 0, 'rtt_avg': 0, 'rtt_max': 0, 'execution_time': 14.031527757644653, 'target': 'www.google.com'}, 'created_at': '2025-08-31T09:33:55.536188', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'count': 4}
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: ping
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 17
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'count': 4}
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: []
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:382 - 未配置任务状态告警
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:735 - 开始检查Ping任务告警配置 - 任务ID: 17
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:739 - Ping告警配置内容: {'enabled': False, 'rules': {'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'status': {'condition': '异常', 'enabled': False, 'level': 'warning'}}}
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:742 - Ping告警配置未启用或为空，跳过检查
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:122 - Ping告警配置检查结果: 0 个告警
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 0 个告警
2025-08-31 09:33:55 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:33:55] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 19, 任务名称: openapi
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 19, 'status': 'failed', 'response_time': 0.0005121231079101562, 'message': '连接失败，返回码: 61', 'details': {'status': 'failed', 'connected': False, 'target': 'localhost:8080', 'host': 'localhost', 'port': 8080, 'execution_time': 0.0005121231079101562, 'return_code': 61, 'message': '连接失败，返回码: 61'}, 'created_at': '2025-08-31T09:33:55.566077', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'timeout': 5}
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: tcp
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 19
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'timeout': 5}
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: []
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:382 - 未配置任务状态告警
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:974 - 开始检查TCP任务告警配置 - 任务ID: 19
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:978 - TCP告警配置内容: {'enabled': True, 'rules': {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}}
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:985 - TCP告警规则: {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:1025 - 检查TCP状态告警 - 任务ID: 19
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:1032 - 任务状态: failed, 告警条件: 异常
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:1042 - TCP状态告警触发: 状态=failed, 条件=异常
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 19, 类型: tcp_status, 级别: warning
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: TCP状态告警 - openapi
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: TCP任务状态为 failed，触发告警条件: 异常
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 449 字符
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 106, 类型: tcp_status, 级别: warning
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:131 - TCP告警配置检查结果: 1 个告警
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 1 个告警
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 1: 类型=tcp_status, 级别=warning, 标题=TCP状态告警 - openapi
2025-08-31 09:33:55 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:33:55] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:33:55 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:33:55] "[31m[1mGET /api/v1/system-variables HTTP/1.1[0m" 401 -
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 20, 任务名称: ceshiapi
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 20, 'status': 'success', 'response_time': None, 'message': '成功完成所有 2 个步骤', 'details': {'status': 'success', 'response_time': 21.04, 'message': '成功完成所有 2 个步骤', 'details': {'steps': [{'step_id': 'step_1756514148453_ny5fx9xny', 'name': '获取 ip', 'status': 'success', 'response_time': 9.02, 'message': '步骤执行成功', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'response': {'status_code': 200, 'headers': {'Server': 'Werkzeug/2.3.7 Python/3.13.2', 'Date': 'Sun, 31 Aug 2025 01:33:55 GMT', 'Content-Type': 'application/json', 'Content-Length': '28', 'Connection': 'close'}, 'content_type': 'application/json', 'body': {'ip': '192.168.31.17'}, 'size': 28}, 'assertions': [], 'extractions': [{'source': 'json_body', 'expression': '$.ip', 'variable_name': '$ip', 'success': True, 'message': '成功提取变量', 'value': '192.168.31.17'}]}, {'step_id': 'step_1756514258232_h4uuugdzo', 'name': '获取名称', 'status': 'success', 'response_time': 6.88, 'message': '步骤执行成功', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '192.168.31.17'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '192.168.31.17'}]}, 'response': {'status_code': 200, 'headers': {'Server': 'Werkzeug/2.3.7 Python/3.13.2', 'Date': 'Sun, 31 Aug 2025 01:33:55 GMT', 'Content-Type': 'application/json', 'Content-Length': '31', 'Connection': 'close'}, 'content_type': 'application/json', 'body': {'hostname': 'peterdembp'}, 'size': 31}, 'assertions': [], 'extractions': []}], 'variables': {}, 'total_assertions': 0, 'passed_assertions': 0, 'start_time': '2025-08-31T09:33:55.589216', 'end_time': '2025-08-31T09:33:55.610271'}}, 'created_at': '2025-08-31T09:33:55.610586', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'steps': [{'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'warning'}, 'assertions': [], 'name': '获取 ip', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'step_id': 'step_1756514148453_ny5fx9xny', 'variables': [{'expression': '$.ip', 'name': '$ip', 'source': 'body'}]}, {'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'severe'}, 'assertions': [], 'name': '获取名称', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '$ip'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '$ip'}]}, 'step_id': 'step_1756514258232_h4uuugdzo', 'variables': []}], 'variables': [], 'authentication': {'accessToken': '', 'headers': [], 'keyName': '', 'keyValue': '', 'location': 'header', 'password': '', 'token': '', 'tokenType': 'Bearer', 'type': 'none', 'username': ''}, 'statusAlertConfig': ['failed'], 'timeoutAlertEnabled': False, 'timeoutThreshold': 5000}
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:70 - 使用嵌套的details结构，找到 2 个步骤
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: api
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: True
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:77 - steps数量: 2
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:165 - 开始检查API步骤告警 - 步骤数量: 2, 配置步骤数量: 2
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:169 - 处理步骤: step_1756514148453_ny5fx9xny
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514148453_ny5fx9xny, 配置=step_1756514148453_ny5fx9xny
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:178 - 找到匹配的步骤配置: step_1756514148453_ny5fx9xny
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 20, 类型: response_time, 级别: warning
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: 步骤 step_1756514148453_ny5fx9xny 响应时间超时
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: 响应时间 9020.00ms 超过阈值 5000.00ms
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 1952 字符
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 107, 类型: response_time, 级别: warning
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:169 - 处理步骤: step_1756514258232_h4uuugdzo
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514258232_h4uuugdzo, 配置=step_1756514148453_ny5fx9xny
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514258232_h4uuugdzo, 配置=step_1756514258232_h4uuugdzo
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:178 - 找到匹配的步骤配置: step_1756514258232_h4uuugdzo
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 20, 类型: response_time, 级别: warning
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: 步骤 step_1756514258232_h4uuugdzo 响应时间超时
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: 响应时间 6880.00ms 超过阈值 5000.00ms
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 1952 字符
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 108, 类型: response_time, 级别: warning
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:87 - API步骤告警检查结果: 2 个告警
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 20
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'steps': [{'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'warning'}, 'assertions': [], 'name': '获取 ip', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'step_id': 'step_1756514148453_ny5fx9xny', 'variables': [{'expression': '$.ip', 'name': '$ip', 'source': 'body'}]}, {'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'severe'}, 'assertions': [], 'name': '获取名称', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '$ip'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '$ip'}]}, 'step_id': 'step_1756514258232_h4uuugdzo', 'variables': []}], 'variables': [], 'authentication': {'accessToken': '', 'headers': [], 'keyName': '', 'keyValue': '', 'location': 'header', 'password': '', 'token': '', 'tokenType': 'Bearer', 'type': 'none', 'username': ''}, 'statusAlertConfig': ['failed'], 'timeoutAlertEnabled': False, 'timeoutThreshold': 5000}
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: ['failed']
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:372 - 开始检查任务状态告警，配置: ['failed']
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:1332 - 检查任务状态告警 - 任务ID: 20
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:1336 - Agent上报的任务状态: success
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:1337 - 状态告警配置: ['failed']
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:1375 - 任务状态 'success' 不在告警配置 ['failed'] 中，不触发告警
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:380 - 未触发任务状态告警
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 2 个告警
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 1: 类型=response_time, 级别=warning, 标题=步骤 step_1756514148453_ny5fx9xny 响应时间超时
2025-08-31 09:33:55 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 2: 类型=response_time, 级别=warning, 标题=步骤 step_1756514258232_h4uuugdzo 响应时间超时
2025-08-31 09:33:55 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:33:55] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:34:00 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:00] "OPTIONS /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:34:00 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:00] "GET /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:34:09 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:09] "OPTIONS /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:34:10 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:10] "GET /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:34:14 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:14] "OPTIONS /api/v1/nodes HTTP/1.1" 200 -
2025-08-31 09:34:14 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:14] "OPTIONS /api/v2/tasks?page=1&size=20 HTTP/1.1" 200 -
2025-08-31 09:34:14 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:14] "GET /api/v1/nodes HTTP/1.1" 200 -
2025-08-31 09:34:14 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:14] "GET /api/v2/tasks?page=1&size=20 HTTP/1.1" 200 -
2025-08-31 09:34:20 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:20] "OPTIONS /api/v2/results?page=1&size=10&start=2025-08-31+00:00:00&end=2025-08-31+23:59:59 HTTP/1.1" 200 -
2025-08-31 09:34:20 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:20] "GET /api/v2/results?page=1&size=10&start=2025-08-31+00:00:00&end=2025-08-31+23:59:59 HTTP/1.1" 200 -
2025-08-31 09:34:22 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:22] "OPTIONS /api/v2/results?task_id=17&start=2025-08-31T08:34:22%2B08:00&end=2025-08-31T09:34:22%2B08:00 HTTP/1.1" 200 -
2025-08-31 09:34:22 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:22] "OPTIONS /api/v2/results?task_id=17&start=2025-08-31T08:34:22%2B08:00&end=2025-08-31T09:34:22%2B08:00 HTTP/1.1" 200 -
2025-08-31 09:34:22 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:22] "GET /api/v2/results?task_id=17&start=2025-08-31T08:34:22%2B08:00&end=2025-08-31T09:34:22%2B08:00 HTTP/1.1" 200 -
2025-08-31 09:34:22 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:22] "GET /api/v2/results?task_id=17&start=2025-08-31T08:34:22%2B08:00&end=2025-08-31T09:34:22%2B08:00 HTTP/1.1" 200 -
2025-08-31 09:34:23 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:23] "OPTIONS /api/v1/tasks/17 HTTP/1.1" 200 -
2025-08-31 09:34:23 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:23] "GET /api/v1/tasks/17 HTTP/1.1" 200 -
2025-08-31 09:34:23 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:23] "OPTIONS /api/v1/tasks/17/results/aggregated?type=ping&page=1&size=100 HTTP/1.1" 200 -
2025-08-31 09:34:23 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:23] "OPTIONS /api/v1/alerts?page=1&per_page=1000 HTTP/1.1" 200 -
2025-08-31 09:34:23 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:23] "OPTIONS /api/v1/alerts?page=1&per_page=1000 HTTP/1.1" 200 -
2025-08-31 09:34:23 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:23] "GET /api/v1/alerts?page=1&per_page=1000 HTTP/1.1" 200 -
2025-08-31 09:34:23 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:23] "GET /api/v1/alerts?page=1&per_page=1000 HTTP/1.1" 200 -
2025-08-31 09:34:24 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:24] "GET /api/v1/tasks/17/results/aggregated?type=ping&page=1&size=100 HTTP/1.1" 200 -
2025-08-31 09:34:30 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:30] "OPTIONS /api/v1/tasks/17/ping/probes/guangzhou/guangzhou/trend?start_time=2025-08-31+08:34:30&end_time=2025-08-31+09:34:30 HTTP/1.1" 200 -
2025-08-31 09:34:30 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:30] "OPTIONS /api/v1/tasks/17/ping/probes/guangzhou/guangzhou/detail HTTP/1.1" 200 -
2025-08-31 09:34:30 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:30] "OPTIONS /api/v1/tasks/17/ping/probes/guangzhou/guangzhou/records?page=1&page_size=20&start_time=2025-08-31+08:34:30&end_time=2025-08-31+09:34:30 HTTP/1.1" 200 -
2025-08-31 09:34:30 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:30] "OPTIONS /api/v1/tasks/17/ping/probes/guangzhou/guangzhou/detail?realtime=true HTTP/1.1" 200 -
2025-08-31 09:34:30 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:30] "OPTIONS /api/v1/tasks/17/ping/probes/guangzhou/guangzhou/trend?start_time=2025-08-31+08:34:30&end_time=2025-08-31+09:34:30 HTTP/1.1" 200 -
2025-08-31 09:34:30 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:30] "OPTIONS /api/v1/tasks/17/ping/probes/guangzhou/guangzhou/records?page=1&page_size=20&start_time=2025-08-31+08:34:30&end_time=2025-08-31+09:34:30 HTTP/1.1" 200 -
2025-08-31 09:34:30 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:30] "GET /api/v1/tasks/17/ping/probes/guangzhou/guangzhou/detail HTTP/1.1" 200 -
2025-08-31 09:34:30 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:30] "GET /api/v1/tasks/17/ping/probes/guangzhou/guangzhou/detail?realtime=true HTTP/1.1" 200 -
2025-08-31 09:34:30 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:30] "GET /api/v1/tasks/17/ping/probes/guangzhou/guangzhou/trend?start_time=2025-08-31+08:34:30&end_time=2025-08-31+09:34:30 HTTP/1.1" 200 -
2025-08-31 09:34:30 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:30] "GET /api/v1/tasks/17/ping/probes/guangzhou/guangzhou/records?page=1&page_size=20&start_time=2025-08-31+08:34:30&end_time=2025-08-31+09:34:30 HTTP/1.1" 200 -
2025-08-31 09:34:30 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:30] "GET /api/v1/tasks/17/ping/probes/guangzhou/guangzhou/trend?start_time=2025-08-31+08:34:30&end_time=2025-08-31+09:34:30 HTTP/1.1" 200 -
2025-08-31 09:34:30 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:30] "GET /api/v1/tasks/17/ping/probes/guangzhou/guangzhou/records?page=1&page_size=20&start_time=2025-08-31+08:34:30&end_time=2025-08-31+09:34:30 HTTP/1.1" 200 -
2025-08-31 09:34:34 - apscheduler.scheduler - DEBUG - base.py:954 - Looking for jobs to run
2025-08-31 09:34:34 - apscheduler.scheduler - DEBUG - base.py:1034 - Next wakeup is due at 2025-08-31 09:39:34.934184+08:00 (in 299.992783 seconds)
2025-08-31 09:34:34 - apscheduler.executors.default - INFO - base.py:123 - Running job "start_scheduler.<locals>.<lambda> (trigger: interval[0:05:00], next run at: 2025-08-31 09:39:34 CST)" (scheduled at 2025-08-31 09:34:34.934184+08:00)
2025-08-31 09:34:34 - apscheduler.executors.default - INFO - base.py:144 - Job "start_scheduler.<locals>.<lambda> (trigger: interval[0:05:00], next run at: 2025-08-31 09:39:34 CST)" executed successfully
2025-08-31 09:34:49 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:49] "OPTIONS /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:34:50 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:50] "GET /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:34:53 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:53] "OPTIONS /api/v2/reports/overview?time_range=1h HTTP/1.1" 200 -
2025-08-31 09:34:53 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:53] "GET /api/v2/reports/overview?time_range=1h HTTP/1.1" 200 -
2025-08-31 09:34:55 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:55] "GET /api/v1/tasks/agent?enabled=true&agent_id=book HTTP/1.1" 200 -
2025-08-31 09:34:55 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 15, 任务名称: ceshi1baidu
2025-08-31 09:34:55 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 15, 'status': 'success', 'response_time': None, 'message': 'HTTP请求成功，状态码: 200', 'details': {'status': 'success', 'response_time': 105.72576522827148, 'message': 'HTTP请求成功，状态码: 200', 'webstatus': '正常', 'details': {'dns_time': 14.621973037719727, 'tcp_time': 21.139144897460938, 'ssl_time': 0, 'first_byte_time': 41.966915130615234, 'download_time': 27.77695655822754, 'http_time': 69.95463371276855, 'status_code': 200, 'response_headers': {'Bdpagetype': '1', 'Bdqid': '0xd309ba2500e4b372', 'Connection': 'keep-alive', 'Content-Encoding': 'gzip', 'Content-Type': 'text/html; charset=utf-8', 'Date': 'Sun, 31 Aug 2025 01:34:55 GMT', 'P3p': 'CP=" OTI DSP COR IVA OUR IND COM ", CP=" OTI DSP COR IVA OUR IND COM "', 'Server': 'BWS/1.1', 'Set-Cookie': 'BAIDUID=1A89B5E754138CD3A7E9C4C49BE9EFCA:FG=1; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, BIDUPSID=1A89B5E754138CD3A7E9C4C49BE9EFCA; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, PSTM=1756604095; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, BAIDUID=1A89B5E754138CD334B0C76BB952F031:FG=1; max-age=31536000; expires=Mon, 31-Aug-26 01:34:55 GMT; domain=.baidu.com; path=/; version=1; comment=bd, BDSVRTM=2; path=/, BD_HOME=1; path=/', 'Tr_id': 'super_0xd309ba2500e4b372', 'Traceid': '1756604095021287527415206890284884734834', 'X-Ua-Compatible': 'IE=Edge,chrome=1', 'X-Xss-Protection': '1;mode=block', 'Transfer-Encoding': 'chunked'}, 'content_length': 623935, 'dns_ips': ['183.240.99.58', '183.240.99.169'], 'final_url': 'http://www.baidu.com/'}}, 'created_at': '2025-08-31T09:34:55.790053', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:34:55 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {}
2025-08-31 09:34:55 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:34:55 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: http
2025-08-31 09:34:55 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:34:55 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:34:55 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:34:55 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 15
2025-08-31 09:34:55 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {}
2025-08-31 09:34:55 - app.services.alert_matcher - INFO - alert_matcher.py:364 - 任务配置为空，跳过任务配置告警检查
2025-08-31 09:34:55 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:34:55 - app.services.alert_matcher - INFO - alert_matcher.py:422 - 开始检查HTTP任务告警配置 - 任务ID: 15
2025-08-31 09:34:55 - app.services.alert_matcher - INFO - alert_matcher.py:426 - HTTP告警配置内容: {'enabled': False, 'rules': {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': False, 'level': 'warning'}}}
2025-08-31 09:34:55 - app.services.alert_matcher - INFO - alert_matcher.py:429 - HTTP告警配置未启用或为空，跳过检查
2025-08-31 09:34:55 - app.services.alert_matcher - INFO - alert_matcher.py:113 - HTTP告警配置检查结果: 0 个告警
2025-08-31 09:34:55 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 0 个告警
2025-08-31 09:34:55 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:34:55] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:35:00 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:35:00] "OPTIONS /api/v1/tasks/17/ping/probes/guangzhou/guangzhou/detail?realtime=true HTTP/1.1" 200 -
2025-08-31 09:35:00 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:35:00] "GET /api/v1/tasks/17/ping/probes/guangzhou/guangzhou/detail?realtime=true HTTP/1.1" 200 -
2025-08-31 09:35:06 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:35:06] "OPTIONS /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:35:06 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:35:06] "GET /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 17, 任务名称: 谷歌
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 17, 'status': 'failed', 'response_time': 14.033034801483154, 'message': '', 'details': {'status': 'failed', 'packet_sent': 4, 'packet_received': 0, 'packet_loss': 100.0, 'rtt_min': 0, 'rtt_avg': 0, 'rtt_max': 0, 'execution_time': 14.033034801483154, 'target': 'www.google.com'}, 'created_at': '2025-08-31T09:35:09.856148', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'count': 4}
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: ping
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 17
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'count': 4}
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: []
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:382 - 未配置任务状态告警
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:735 - 开始检查Ping任务告警配置 - 任务ID: 17
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:739 - Ping告警配置内容: {'enabled': False, 'rules': {'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'status': {'condition': '异常', 'enabled': False, 'level': 'warning'}}}
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:742 - Ping告警配置未启用或为空，跳过检查
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:122 - Ping告警配置检查结果: 0 个告警
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 0 个告警
2025-08-31 09:35:09 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:35:09] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 19, 任务名称: openapi
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 19, 'status': 'failed', 'response_time': 0.0005388259887695312, 'message': '连接失败，返回码: 61', 'details': {'status': 'failed', 'connected': False, 'target': 'localhost:8080', 'host': 'localhost', 'port': 8080, 'execution_time': 0.0005388259887695312, 'return_code': 61, 'message': '连接失败，返回码: 61'}, 'created_at': '2025-08-31T09:35:09.886972', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'timeout': 5}
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: tcp
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 19
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'timeout': 5}
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: []
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:382 - 未配置任务状态告警
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:974 - 开始检查TCP任务告警配置 - 任务ID: 19
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:978 - TCP告警配置内容: {'enabled': True, 'rules': {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}}
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:985 - TCP告警规则: {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:1025 - 检查TCP状态告警 - 任务ID: 19
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:1032 - 任务状态: failed, 告警条件: 异常
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:1042 - TCP状态告警触发: 状态=failed, 条件=异常
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 19, 类型: tcp_status, 级别: warning
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: TCP状态告警 - openapi
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: TCP任务状态为 failed，触发告警条件: 异常
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 449 字符
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 109, 类型: tcp_status, 级别: warning
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:131 - TCP告警配置检查结果: 1 个告警
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 1 个告警
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 1: 类型=tcp_status, 级别=warning, 标题=TCP状态告警 - openapi
2025-08-31 09:35:09 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:35:09] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:35:09 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:35:09] "[31m[1mGET /api/v1/system-variables HTTP/1.1[0m" 401 -
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 20, 任务名称: ceshiapi
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 20, 'status': 'success', 'response_time': None, 'message': '成功完成所有 2 个步骤', 'details': {'status': 'success', 'response_time': 28.33, 'message': '成功完成所有 2 个步骤', 'details': {'steps': [{'step_id': 'step_1756514148453_ny5fx9xny', 'name': '获取 ip', 'status': 'success', 'response_time': 10.14, 'message': '步骤执行成功', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'response': {'status_code': 200, 'headers': {'Server': 'Werkzeug/2.3.7 Python/3.13.2', 'Date': 'Sun, 31 Aug 2025 01:35:09 GMT', 'Content-Type': 'application/json', 'Content-Length': '28', 'Connection': 'close'}, 'content_type': 'application/json', 'body': {'ip': '192.168.31.17'}, 'size': 28}, 'assertions': [], 'extractions': [{'source': 'json_body', 'expression': '$.ip', 'variable_name': '$ip', 'success': True, 'message': '成功提取变量', 'value': '192.168.31.17'}]}, {'step_id': 'step_1756514258232_h4uuugdzo', 'name': '获取名称', 'status': 'success', 'response_time': 9.1, 'message': '步骤执行成功', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '192.168.31.17'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '192.168.31.17'}]}, 'response': {'status_code': 200, 'headers': {'Server': 'Werkzeug/2.3.7 Python/3.13.2', 'Date': 'Sun, 31 Aug 2025 01:35:09 GMT', 'Content-Type': 'application/json', 'Content-Length': '31', 'Connection': 'close'}, 'content_type': 'application/json', 'body': {'hostname': 'peterdembp'}, 'size': 31}, 'assertions': [], 'extractions': []}], 'variables': {}, 'total_assertions': 0, 'passed_assertions': 0, 'start_time': '2025-08-31T09:35:09.918898', 'end_time': '2025-08-31T09:35:09.947236'}}, 'created_at': '2025-08-31T09:35:09.947607', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'steps': [{'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'warning'}, 'assertions': [], 'name': '获取 ip', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'step_id': 'step_1756514148453_ny5fx9xny', 'variables': [{'expression': '$.ip', 'name': '$ip', 'source': 'body'}]}, {'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'severe'}, 'assertions': [], 'name': '获取名称', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '$ip'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '$ip'}]}, 'step_id': 'step_1756514258232_h4uuugdzo', 'variables': []}], 'variables': [], 'authentication': {'accessToken': '', 'headers': [], 'keyName': '', 'keyValue': '', 'location': 'header', 'password': '', 'token': '', 'tokenType': 'Bearer', 'type': 'none', 'username': ''}, 'statusAlertConfig': ['failed'], 'timeoutAlertEnabled': False, 'timeoutThreshold': 5000}
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:70 - 使用嵌套的details结构，找到 2 个步骤
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: api
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: True
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:77 - steps数量: 2
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:165 - 开始检查API步骤告警 - 步骤数量: 2, 配置步骤数量: 2
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:169 - 处理步骤: step_1756514148453_ny5fx9xny
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514148453_ny5fx9xny, 配置=step_1756514148453_ny5fx9xny
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:178 - 找到匹配的步骤配置: step_1756514148453_ny5fx9xny
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 20, 类型: response_time, 级别: warning
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: 步骤 step_1756514148453_ny5fx9xny 响应时间超时
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: 响应时间 10140.00ms 超过阈值 5000.00ms
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 1952 字符
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 110, 类型: response_time, 级别: warning
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:169 - 处理步骤: step_1756514258232_h4uuugdzo
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514258232_h4uuugdzo, 配置=step_1756514148453_ny5fx9xny
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514258232_h4uuugdzo, 配置=step_1756514258232_h4uuugdzo
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:178 - 找到匹配的步骤配置: step_1756514258232_h4uuugdzo
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 20, 类型: response_time, 级别: warning
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: 步骤 step_1756514258232_h4uuugdzo 响应时间超时
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: 响应时间 9100.00ms 超过阈值 5000.00ms
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 1952 字符
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 111, 类型: response_time, 级别: warning
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:87 - API步骤告警检查结果: 2 个告警
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 20
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'steps': [{'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'warning'}, 'assertions': [], 'name': '获取 ip', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'step_id': 'step_1756514148453_ny5fx9xny', 'variables': [{'expression': '$.ip', 'name': '$ip', 'source': 'body'}]}, {'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'severe'}, 'assertions': [], 'name': '获取名称', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '$ip'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '$ip'}]}, 'step_id': 'step_1756514258232_h4uuugdzo', 'variables': []}], 'variables': [], 'authentication': {'accessToken': '', 'headers': [], 'keyName': '', 'keyValue': '', 'location': 'header', 'password': '', 'token': '', 'tokenType': 'Bearer', 'type': 'none', 'username': ''}, 'statusAlertConfig': ['failed'], 'timeoutAlertEnabled': False, 'timeoutThreshold': 5000}
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: ['failed']
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:372 - 开始检查任务状态告警，配置: ['failed']
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:1332 - 检查任务状态告警 - 任务ID: 20
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:1336 - Agent上报的任务状态: success
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:1337 - 状态告警配置: ['failed']
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:1375 - 任务状态 'success' 不在告警配置 ['failed'] 中，不触发告警
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:380 - 未触发任务状态告警
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 2 个告警
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 1: 类型=response_time, 级别=warning, 标题=步骤 step_1756514148453_ny5fx9xny 响应时间超时
2025-08-31 09:35:09 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 2: 类型=response_time, 级别=warning, 标题=步骤 step_1756514258232_h4uuugdzo 响应时间超时
2025-08-31 09:35:09 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:35:09] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:35:30 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:35:30] "OPTIONS /api/v1/tasks/17/ping/probes/guangzhou/guangzhou/detail?realtime=true HTTP/1.1" 200 -
2025-08-31 09:35:30 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:35:30] "GET /api/v1/tasks/17/ping/probes/guangzhou/guangzhou/detail?realtime=true HTTP/1.1" 200 -
2025-08-31 09:35:42 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:35:42] "OPTIONS /api/v2/reports/overview?time_range=1h HTTP/1.1" 200 -
2025-08-31 09:35:42 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:35:42] "GET /api/v2/reports/overview?time_range=1h HTTP/1.1" 200 -
2025-08-31 09:35:45 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:35:45] "OPTIONS /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:35:46 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:35:46] "GET /api/v2/reports/overview?time_range=1d HTTP/1.1" 200 -
2025-08-31 09:35:50 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:35:50] "[33mOPTIONS /v1/auth/login HTTP/1.1[0m" 404 -
2025-08-31 09:35:55 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:35:55] "OPTIONS /api/v2/tasks?task_type=tcp HTTP/1.1" 200 -
2025-08-31 09:35:55 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:35:55] "GET /api/v2/tasks?task_type=tcp HTTP/1.1" 200 -
2025-08-31 09:35:55 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:35:55] "OPTIONS /api/v2/reports/tcp?task_type=tcp&time_range=1d HTTP/1.1" 200 -
2025-08-31 09:35:55 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:35:55] "GET /api/v2/reports/tcp?task_type=tcp&time_range=1d HTTP/1.1" 200 -
2025-08-31 09:36:00 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:36:00] "OPTIONS /api/v1/tasks/17/ping/probes/guangzhou/guangzhou/detail?realtime=true HTTP/1.1" 200 -
2025-08-31 09:36:00 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:36:00] "GET /api/v1/tasks/17/ping/probes/guangzhou/guangzhou/detail?realtime=true HTTP/1.1" 200 -
2025-08-31 09:36:08 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:36:08] "[33mOPTIONS /v1/auth/login HTTP/1.1[0m" 404 -
2025-08-31 09:36:10 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:36:10] "GET /api/v1/tasks/agent?enabled=true&agent_id=book HTTP/1.1" 200 -
2025-08-31 09:36:10 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 15, 任务名称: ceshi1baidu
2025-08-31 09:36:10 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 15, 'status': 'success', 'response_time': None, 'message': 'HTTP请求成功，状态码: 200', 'details': {'status': 'success', 'response_time': 92.04387664794922, 'message': 'HTTP请求成功，状态码: 200', 'webstatus': '正常', 'details': {'dns_time': 6.083011627197266, 'tcp_time': 17.549991607666016, 'ssl_time': 0, 'first_byte_time': 40.62700271606445, 'download_time': 27.687788009643555, 'http_time': 68.40801239013672, 'status_code': 200, 'response_headers': {'Bdpagetype': '1', 'Bdqid': '0xcaff4b7b00e54746', 'Connection': 'keep-alive', 'Content-Encoding': 'gzip', 'Content-Type': 'text/html; charset=utf-8', 'Date': 'Sun, 31 Aug 2025 01:36:10 GMT', 'P3p': 'CP=" OTI DSP COR IVA OUR IND COM ", CP=" OTI DSP COR IVA OUR IND COM "', 'Server': 'BWS/1.1', 'Set-Cookie': 'BAIDUID=F3617E8246440C4D14B453B5DE7FE1D1:FG=1; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, BIDUPSID=F3617E8246440C4D14B453B5DE7FE1D1; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, PSTM=1756604170; expires=Thu, 31-Dec-37 23:55:55 GMT; max-age=2147483647; path=/; domain=.baidu.com, BAIDUID=F3617E8246440C4D50E46D12969E72CD:FG=1; max-age=31536000; expires=Mon, 31-Aug-26 01:36:10 GMT; domain=.baidu.com; path=/; version=1; comment=bd, BDSVRTM=2; path=/, BD_HOME=1; path=/', 'Tr_id': 'super_0xcaff4b7b00e54746', 'Traceid': '1756604170402123777014627493106390746950', 'X-Ua-Compatible': 'IE=Edge,chrome=1', 'X-Xss-Protection': '1;mode=block', 'Transfer-Encoding': 'chunked'}, 'content_length': 623976, 'dns_ips': ['183.240.99.58', '183.240.99.169'], 'final_url': 'http://www.baidu.com/'}}, 'created_at': '2025-08-31T09:36:10.142475', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:36:10 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {}
2025-08-31 09:36:10 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:36:10 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: http
2025-08-31 09:36:10 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:36:10 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:36:10 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:36:10 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 15
2025-08-31 09:36:10 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {}
2025-08-31 09:36:10 - app.services.alert_matcher - INFO - alert_matcher.py:364 - 任务配置为空，跳过任务配置告警检查
2025-08-31 09:36:10 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:36:10 - app.services.alert_matcher - INFO - alert_matcher.py:422 - 开始检查HTTP任务告警配置 - 任务ID: 15
2025-08-31 09:36:10 - app.services.alert_matcher - INFO - alert_matcher.py:426 - HTTP告警配置内容: {'enabled': False, 'rules': {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': False, 'level': 'warning'}}}
2025-08-31 09:36:10 - app.services.alert_matcher - INFO - alert_matcher.py:429 - HTTP告警配置未启用或为空，跳过检查
2025-08-31 09:36:10 - app.services.alert_matcher - INFO - alert_matcher.py:113 - HTTP告警配置检查结果: 0 个告警
2025-08-31 09:36:10 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 0 个告警
2025-08-31 09:36:10 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:36:10] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:36:15 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:36:15] "POST /api/v1/nodes/heartbeat HTTP/1.1" 200 -
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 17, 任务名称: 谷歌
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 17, 'status': 'failed', 'response_time': 14.033122777938843, 'message': '', 'details': {'status': 'failed', 'packet_sent': 4, 'packet_received': 0, 'packet_loss': 100.0, 'rtt_min': 0, 'rtt_avg': 0, 'rtt_max': 0, 'execution_time': 14.033122777938843, 'target': 'www.google.com'}, 'created_at': '2025-08-31T09:36:24.199081', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'count': 4}
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: ping
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 17
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'count': 4}
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: []
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:382 - 未配置任务状态告警
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:735 - 开始检查Ping任务告警配置 - 任务ID: 17
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:739 - Ping告警配置内容: {'enabled': False, 'rules': {'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'status': {'condition': '异常', 'enabled': False, 'level': 'warning'}}}
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:742 - Ping告警配置未启用或为空，跳过检查
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:122 - Ping告警配置检查结果: 0 个告警
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 0 个告警
2025-08-31 09:36:24 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:36:24] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 19, 任务名称: openapi
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 19, 'status': 'failed', 'response_time': 0.0005121231079101562, 'message': '连接失败，返回码: 61', 'details': {'status': 'failed', 'connected': False, 'target': 'localhost:8080', 'host': 'localhost', 'port': 8080, 'execution_time': 0.0005121231079101562, 'return_code': 61, 'message': '连接失败，返回码: 61'}, 'created_at': '2025-08-31T09:36:24.231397', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'timeout': 5}
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: tcp
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: False
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 19
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'timeout': 5}
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: []
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:382 - 未配置任务状态告警
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:974 - 开始检查TCP任务告警配置 - 任务ID: 19
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:978 - TCP告警配置内容: {'enabled': True, 'rules': {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}}
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:985 - TCP告警规则: {'dns_ip': {'enabled': False, 'expected_ips': [], 'level': 'warning'}, 'execution_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 5000}, 'packet_loss': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 10}, 'response_code': {'condition': 'eq', 'enabled': False, 'level': 'warning', 'value': 404}, 'response_time': {'condition': 'gt', 'enabled': False, 'level': 'warning', 'value': 1000}, 'status': {'condition': '异常', 'enabled': True, 'level': 'warning'}}
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:1025 - 检查TCP状态告警 - 任务ID: 19
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:1032 - 任务状态: failed, 告警条件: 异常
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:1042 - TCP状态告警触发: 状态=failed, 条件=异常
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 19, 类型: tcp_status, 级别: warning
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: TCP状态告警 - openapi
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: TCP任务状态为 failed，触发告警条件: 异常
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 449 字符
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 112, 类型: tcp_status, 级别: warning
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:131 - TCP告警配置检查结果: 1 个告警
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 1 个告警
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 1: 类型=tcp_status, 级别=warning, 标题=TCP状态告警 - openapi
2025-08-31 09:36:24 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:36:24] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:36:24 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:36:24] "[31m[1mGET /api/v1/system-variables HTTP/1.1[0m" 401 -
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:37 - 开始处理任务告警匹配 - 任务ID: 20, 任务名称: ceshiapi
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:38 - Agent上报数据: {'task_id': 20, 'status': 'success', 'response_time': None, 'message': '成功完成所有 2 个步骤', 'details': {'status': 'success', 'response_time': 33.41, 'message': '成功完成所有 2 个步骤', 'details': {'steps': [{'step_id': 'step_1756514148453_ny5fx9xny', 'name': '获取 ip', 'status': 'success', 'response_time': 13.5, 'message': '步骤执行成功', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'response': {'status_code': 200, 'headers': {'Server': 'Werkzeug/2.3.7 Python/3.13.2', 'Date': 'Sun, 31 Aug 2025 01:36:24 GMT', 'Content-Type': 'application/json', 'Content-Length': '28', 'Connection': 'close'}, 'content_type': 'application/json', 'body': {'ip': '192.168.31.17'}, 'size': 28}, 'assertions': [], 'extractions': [{'source': 'json_body', 'expression': '$.ip', 'variable_name': '$ip', 'success': True, 'message': '成功提取变量', 'value': '192.168.31.17'}]}, {'step_id': 'step_1756514258232_h4uuugdzo', 'name': '获取名称', 'status': 'success', 'response_time': 9.22, 'message': '步骤执行成功', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '192.168.31.17'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '192.168.31.17'}]}, 'response': {'status_code': 200, 'headers': {'Server': 'Werkzeug/2.3.7 Python/3.13.2', 'Date': 'Sun, 31 Aug 2025 01:36:24 GMT', 'Content-Type': 'application/json', 'Content-Length': '31', 'Connection': 'close'}, 'content_type': 'application/json', 'body': {'hostname': 'peterdembp'}, 'size': 31}, 'assertions': [], 'extractions': []}], 'variables': {}, 'total_assertions': 0, 'passed_assertions': 0, 'start_time': '2025-08-31T09:36:24.263321', 'end_time': '2025-08-31T09:36:24.296753'}}, 'created_at': '2025-08-31T09:36:24.297139', 'agent_id': 'book', 'agent_area': 'guangzhou', 'tenant_id': '015aef7d-d196-414e-8377-99d226be6873'}
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:42 - 任务配置: {'steps': [{'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'warning'}, 'assertions': [], 'name': '获取 ip', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'step_id': 'step_1756514148453_ny5fx9xny', 'variables': [{'expression': '$.ip', 'name': '$ip', 'source': 'body'}]}, {'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'severe'}, 'assertions': [], 'name': '获取名称', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '$ip'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '$ip'}]}, 'step_id': 'step_1756514258232_h4uuugdzo', 'variables': []}], 'variables': [], 'authentication': {'accessToken': '', 'headers': [], 'keyName': '', 'keyValue': '', 'location': 'header', 'password': '', 'token': '', 'tokenType': 'Bearer', 'type': 'none', 'username': ''}, 'statusAlertConfig': ['failed'], 'timeoutAlertEnabled': False, 'timeoutThreshold': 5000}
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:50 - 找到 0 个启用的告警配置
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:70 - 使用嵌套的details结构，找到 2 个步骤
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:73 - 任务类型: api
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:74 - details结构: <class 'dict'>
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:75 - details中是否包含steps: True
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:77 - steps数量: 2
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:165 - 开始检查API步骤告警 - 步骤数量: 2, 配置步骤数量: 2
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:169 - 处理步骤: step_1756514148453_ny5fx9xny
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514148453_ny5fx9xny, 配置=step_1756514148453_ny5fx9xny
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:178 - 找到匹配的步骤配置: step_1756514148453_ny5fx9xny
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 20, 类型: response_time, 级别: warning
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: 步骤 step_1756514148453_ny5fx9xny 响应时间超时
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: 响应时间 13500.00ms 超过阈值 5000.00ms
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 1952 字符
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 113, 类型: response_time, 级别: warning
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:169 - 处理步骤: step_1756514258232_h4uuugdzo
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514258232_h4uuugdzo, 配置=step_1756514148453_ny5fx9xny
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:175 - 比较步骤ID: 执行结果=step_1756514258232_h4uuugdzo, 配置=step_1756514258232_h4uuugdzo
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:178 - 找到匹配的步骤配置: step_1756514258232_h4uuugdzo
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:1454 - 开始创建告警 - 任务ID: 20, 类型: response_time, 级别: warning
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:1455 - 告警标题: 步骤 step_1756514258232_h4uuugdzo 响应时间超时
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:1456 - 告警内容: 响应时间 9220.00ms 超过阈值 5000.00ms
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:1481 - 设置告警快照数据: 1952 字符
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:1487 - 告警成功保存到数据库 - 告警ID: 114, 类型: response_time, 级别: warning
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:87 - API步骤告警检查结果: 2 个告警
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:96 - 全局告警检查结果: 0 个告警
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:357 - 开始检查任务配置告警 - 任务ID: 20
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:361 - 任务配置内容: {'steps': [{'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'warning'}, 'assertions': [], 'name': '获取 ip', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [], 'url': 'http://192.168.31.17:6000/ip', 'urlParameters': []}, 'step_id': 'step_1756514148453_ny5fx9xny', 'variables': [{'expression': '$.ip', 'name': '$ip', 'source': 'body'}]}, {'alerts': {'allowedStatusCodes': '200', 'responseTimeAlertLevel': 'warning', 'responseTimeThreshold': 5, 'statusCodeAlertLevel': 'severe'}, 'assertions': [], 'name': '获取名称', 'request': {'body': '', 'contentType': 'application/json', 'headers': [], 'method': 'GET', 'params': [{'key': 'ip', 'value': '$ip'}], 'url': 'http://192.168.31.17:6000/name', 'urlParameters': [{'key': 'ip', 'value': '$ip'}]}, 'step_id': 'step_1756514258232_h4uuugdzo', 'variables': []}], 'variables': [], 'authentication': {'accessToken': '', 'headers': [], 'keyName': '', 'keyValue': '', 'location': 'header', 'password': '', 'token': '', 'tokenType': 'Bearer', 'type': 'none', 'username': ''}, 'statusAlertConfig': ['failed'], 'timeoutAlertEnabled': False, 'timeoutThreshold': 5000}
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:369 - 状态告警配置: ['failed']
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:372 - 开始检查任务状态告警，配置: ['failed']
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:1332 - 检查任务状态告警 - 任务ID: 20
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:1336 - Agent上报的任务状态: success
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:1337 - 状态告警配置: ['failed']
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:1375 - 任务状态 'success' 不在告警配置 ['failed'] 中，不触发告警
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:380 - 未触发任务状态告警
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:386 - 超时告警启用状态: False
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:399 - 未启用任务超时告警
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:104 - 任务配置告警检查结果: 0 个告警
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:134 - 总共生成 2 个告警
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 1: 类型=response_time, 级别=warning, 标题=步骤 step_1756514148453_ny5fx9xny 响应时间超时
2025-08-31 09:36:24 - app.services.alert_matcher - INFO - alert_matcher.py:136 - 告警 2: 类型=response_time, 级别=warning, 标题=步骤 step_1756514258232_h4uuugdzo 响应时间超时
2025-08-31 09:36:24 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:36:24] "[35m[1mPOST /api/v1/results HTTP/1.1[0m" 201 -
2025-08-31 09:36:30 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:36:30] "OPTIONS /api/v1/tasks/17/ping/probes/guangzhou/guangzhou/detail?realtime=true HTTP/1.1" 200 -
2025-08-31 09:36:30 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:36:30] "GET /api/v1/tasks/17/ping/probes/guangzhou/guangzhou/detail?realtime=true HTTP/1.1" 200 -
2025-08-31 09:36:49 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:36:49] "OPTIONS /api/v2/tasks?task_type=tcp HTTP/1.1" 200 -
2025-08-31 09:36:49 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:36:49] "GET /api/v2/tasks?task_type=tcp HTTP/1.1" 200 -
2025-08-31 09:36:49 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:36:49] "OPTIONS /api/v2/reports/tcp?task_type=tcp&time_range=1d HTTP/1.1" 200 -
2025-08-31 09:36:50 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:36:50] "GET /api/v2/reports/tcp?task_type=tcp&time_range=1d HTTP/1.1" 200 -
2025-08-31 09:36:50 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:36:50] "GET /api/v2/tasks?task_type=tcp HTTP/1.1" 200 -
2025-08-31 09:36:51 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:36:51] "GET /api/v2/reports/tcp?task_type=tcp&time_range=1d HTTP/1.1" 200 -
2025-08-31 09:37:00 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:37:00] "OPTIONS /api/v2/tasks?task_type=tcp HTTP/1.1" 200 -
2025-08-31 09:37:00 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:37:00] "GET /api/v2/tasks?task_type=tcp HTTP/1.1" 200 -
2025-08-31 09:37:00 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:37:00] "OPTIONS /api/v2/reports/tcp?task_type=tcp&time_range=1d HTTP/1.1" 200 -
2025-08-31 09:37:00 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:37:00] "GET /api/v2/reports/tcp?task_type=tcp&time_range=1d HTTP/1.1" 200 -
2025-08-31 09:37:01 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:37:01] "GET /api/v2/tasks?task_type=tcp HTTP/1.1" 200 -
2025-08-31 09:37:01 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:37:01] "GET /api/v2/tasks?task_type=tcp HTTP/1.1" 200 -
2025-08-31 09:37:01 - werkzeug - INFO - _internal.py:187 - 127.0.0.1 - - [31/Aug/2025 09:37:01] "GET /api/v2/reports/tcp?task_type=tcp&time_range=1d HTTP/1.1" 200 -
2025-08-31 09:37:17 - werkzeug - INFO - _internal.py:187 -  * Detected change in '/Users/peter/Documents/code/boce/it-dialer/backend/app/api/v2/reports.py', reloading
